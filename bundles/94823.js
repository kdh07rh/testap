"use strict";(self.webpackChunkjennifer5_frontend=self.webpackChunkjennifer5_frontend||[]).push([[94823],{28416:(q,O,o)=>{o.d(O,{MJ:()=>h,bs:()=>A,cl:()=>Q});var e=o(86617),b=o(47577),B=o(27664),F=o(73529),$=o(95447);function Q(a){const r=new Map,M=new Map;a.forEach(c=>{r.set(c.treeIndex,c),c.data.sid!==-1&&M.set(c.data.sid,c.treeIndex)});const D=(0,b.KR)([]),C=c=>{const E=M.get(c);if(typeof E!="string")return"";const W=[],m=E.split(".");for(;m.length>0;){const U=r.get(m.join("."));U&&(W.push(U.label),m.pop())}D.value=[...W]};return{parentNames:(0,b.tB)(D),setParentNames:C}}function A(a){const{parentNames:r,setParentNames:M}=Q(a),D=(0,b.KR)(""),C=c=>{M(c);const E=[...r.value],W=E.shift();D.value=(E.length>0?E.reverse().join(" / ")+" / ":"")+`<strong>${W}</strong>`};return{fullName:(0,b.tB)(D),setFullName:C}}function R(a){const r=a.filter(C=>C.resourceType==="domain"),M=ref(r[0]);return{selectedDomain:M,setSelectedDomain:C=>{M.value=r.filter(c=>c.data.sid===C)[0]}}}function h(a=-1,r,M,D){const C=(0,B.qm)(),c=(0,b.KR)([{resourceType:"instance",tree:[]}]),E=m=>F.cw.get([m],C.valueOf()-1e3*60*60*24,C.valueOf()).then(U=>{const G=U.map(K=>({...K,existData:K.status===e.xr.LIVE})).filter(K=>M===!0?K.existData:!0);c.value=[{resourceType:"instance",tree:Array.from((0,$.XP)(G,"instance"))}]}),W=m=>{const U=c.value[0].tree;c.value=[{resourceType:"instance",tree:U.map(G=>({...G,check:m.includes(G.data[D??"oid"])?"on":"off"}))}]};return a!==-1&&E(a).then(()=>{r&&W(r)}),{resources:c,setResources:E,checkResources:W}}},57222:(q,O,o)=>{o.d(O,{v:()=>b});var e=o(47577);function b(B){const F=()=>{history.pushState(null,document.title,location.href)},$=()=>{F(),B()};(0,e.KC)(()=>{F(),window.addEventListener("popstate",$)}),(0,e.xo)(()=>{window.removeEventListener("popstate",$)})}},73529:(q,O,o)=>{o.d(O,{cw:()=>F});var e=o(21005),b=o(27664);function B(A,R,h){let a=(0,b.qm)(R).second(0).millisecond(0),r=(0,b.qm)(h).second(0).millisecond(0);return{format:"json",sid:A,sids:A,startTime:a.valueOf(),endTime:r.valueOf()}}const F={async get(A,R,h){return e.A.get("/agent/names/tree",{params:B(A,R,h)}).then(a=>{const r=a.data;return Array.isArray(r)?r:[]}).catch(a=>{throw a})}},$={async get(A,R,h){return e.A.get("/biz/group/treeList/tree",{params:B(A,R,h)}).then(a=>{const r=a.data;return Array.isArray(r)?r:[]}).catch(a=>{throw a})}},Q=function(A,R,h){const a=new Promise((M,D)=>{F.get(A,R,h).then(C=>{const c=normalizeOidConfigResponse(C,"instance").map(m=>({...m,check:"no-check",selected:!1})),E=c.map(m=>m.resourceType==="domain"?{...m,noInteraction:!0}:m),W=c.filter(m=>m.resourceType==="domain").map(m=>({...m,fold:"no-fold",noFoldPadding:!0}));M([{resourceType:"domain",tree:W},{resourceType:"instance",tree:Array.from(E)}])}).catch(C=>{D(C)})}),r=new Promise((M,D)=>{$.get(A,R,h).then(C=>{const c=normalizeOidConfigResponse(C,"business").map(E=>({...E,check:"no-check",selected:!1})).map(E=>E.resourceType==="domain"?{...E,noInteraction:!0}:E);M([{resourceType:"business",tree:Array.from(c)}])}).catch(C=>{D(C)})});return Promise.all([a,r])}},78264:(q,O,o)=>{o.r(O),o.d(O,{default:()=>Vt});var e=o(47577);const b={class:"app-ctrl event-ctrl"},B={class:"left"},F={key:0,class:"right"},$={class:"component"},Q={key:1,class:"right"},A={key:2,class:"right"};function R(t,s,i,n,d,I){const g=(0,e.g2)("domain-tree-layer"),f=(0,e.g2)("dropdown"),l=(0,e.g2)("btn"),L=(0,e.g2)("base-header"),w=(0,e.g2)("loading-indicator"),u=(0,e.g2)("cards"),P=(0,e.g2)("confirm-window"),N=(0,e.g2)("domain-window"),y=(0,e.g2)("card-form");return(0,e.uX)(),(0,e.CE)("div",b,[(0,e.bo)((0,e.Lk)("div",B,[(0,e.bF)(g,{"is-layer":!1,"show-title":!1})],512),[[e.aG,t.showDomainTreeLayer&&t.screenMode==="list"]]),s[17]||(s[17]=(0,e.eW)()),t.screenMode==="list"?((0,e.uX)(),(0,e.CE)("div",F,[(0,e.bF)(L,{title:t.i18nMessages.comparisonTitle,"use-domain-tree-btn":!0,"active-domain-tree":t.showDomainTreeLayer,onToggleDomaintree:s[1]||(s[1]=()=>t.showDomainTreeLayer=!t.showDomainTreeLayer)},{tools:(0,e.k6)(()=>[(0,e.Lk)("div",$,[(0,e.bF)(f,{items:t.filteredTargetItems,"selected-value":t.filterType,onOnchange:t.onChangeFilterType,"is-simple-style":"",normal:""},null,8,["items","selected-value","onOnchange"])]),s[5]||(s[5]=(0,e.eW)()),s[6]||(s[6]=(0,e.Lk)("div",{class:"splitter"},null,-1)),s[7]||(s[7]=(0,e.eW)()),(0,e.bF)(l,{normal:"","icon-first":"",class:"border-none",disabled:t.selectedDomain.resourceType!=="domain",items:[{text:t.i18nMessages.add,iconType:t.iconTypes.add}],onClick:t.onClickAddSetting},null,8,["disabled","items","onClick"]),s[8]||(s[8]=(0,e.eW)()),(0,e.bF)(l,{class:"border-none",normal:"","icon-first":"",disabled:t.checkedItems.length===0,items:[{iconType:t.iconTypes.trashcan}],"tooltip-options":{message:t.i18nMessages.delete},onClick:s[0]||(s[0]=()=>t.confirmMessage=t.i18nMessages.M0270)},null,8,["disabled","items","tooltip-options"])]),_:1},8,["title","active-domain-tree"]),s[9]||(s[9]=(0,e.eW)()),t.useLoading?((0,e.uX)(),(0,e.Wv)(w,{key:0})):(0,e.Q3)("v-if",!0),s[10]||(s[10]=(0,e.eW)()),(0,e.bF)(u),s[11]||(s[11]=(0,e.eW)()),t.confirmMessage!==""?((0,e.uX)(),(0,e.Wv)(P,{key:1,message:t.confirmMessage,onCancel:s[2]||(s[2]=()=>t.confirmMessage=""),onApply:t.onClickDeleteSettings},null,8,["message","onApply"])):(0,e.Q3)("v-if",!0)])):t.screenMode==="modify"?((0,e.uX)(),(0,e.CE)("div",Q,[(0,e.bF)(L,{title:t.createTitle(t.selectedItem),"use-back-btn":!0,"use-delete-btn":!0,onDeleteSetting:t.onClickDeleteSetting,onClickBackbtn:t.onClickBackBtn},{tools:(0,e.k6)(()=>[(0,e.bF)(l,{normal:"",items:[{text:t.i18nMessages.copyDomainSettings}],pressed:t.activeDomainWindow,loading:t.copyLoading,onClick:s[3]||(s[3]=()=>t.activeDomainWindow=!t.activeDomainWindow)},null,8,["items","pressed","loading"]),s[12]||(s[12]=(0,e.eW)(`

                    \xA0
                    `)),s[13]||(s[13]=(0,e.Lk)("div",{class:"splitter"},null,-1)),s[14]||(s[14]=(0,e.eW)()),t.activeDomainWindow?((0,e.uX)(),(0,e.Wv)(N,{key:0,domains:t.domains,onCancel:s[4]||(s[4]=()=>t.activeDomainWindow=!1),onApply:t.onCopyDomainSettings},null,8,["domains","onApply"])):(0,e.Q3)("v-if",!0)]),_:1},8,["title","onDeleteSetting","onClickBackbtn"]),s[15]||(s[15]=(0,e.eW)()),(0,e.bF)(y,{"is-new":!1,onCancel:t.onClickBackBtn},null,8,["onCancel"])])):((0,e.uX)(),(0,e.CE)("div",A,[(0,e.bF)(L,{title:t.i18nMessages.addEventSetting},null,8,["title"]),s[16]||(s[16]=(0,e.eW)()),(0,e.bF)(y,{"is-new":!0,onCancel:t.onClickBackBtn},null,8,["onCancel"])]))])}var h=o(35375),a=o(62078),r=o(65267),M=o(22984),D=o(83987);const C={key:0,class:"cards"},c={key:1,class:"no-cards"};function E(t,s,i,n,d,I){const g=(0,e.g2)("card");return t.cardItems.length>0?((0,e.uX)(),(0,e.CE)("div",C,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(t.cardItems,(f,l)=>((0,e.uX)(),(0,e.Wv)(g,{key:l,item:f,checked:t.isChecked(f),onSelect:t.onClickCardItem,onActive:t.onClickActiveCardItem,onCheck:L=>t.onCheckCardItem(f,L)},null,8,["item","checked","onSelect","onActive","onCheck"]))),128))])):((0,e.uX)(),(0,e.CE)("div",c,(0,e.v_)(t.i18n.M0703),1))}var W=o(28416),m=o(1401),U=o(21005),G=o(97116),K=o(27664),p=o(6373),v=o(86617);function ae(){return{basePercent:0,gtype:100,eventLevel:1,metricPosition:0,metricId:-1,filterValue:0,applied:!1,iconRecoveryTime:6e4,filterMetricId:-1,metricComparator:0,customCompareDate:(0,K.qm)().format("YYYYMMDD"),filterApplied:!1,customMessage:""}}function pe(t){return t===100?p.Ru.get("ui.label.instance"):t===102?p.Ru.get("ui.label.business"):p.Ru.get("ui.label.domain")}function re(t){const s=Object.keys(v.t7),i=Object.values(v.t7),n=s.filter((d,I)=>i[I]===t)[0];return p.Ru.get(`ui.mx.${n}`)}function le(t){const s=re(t.setting.metricId),i=t.setting.metricComparator==v.hm.GREATER_THAN?">":"<";let n="";return t.setting.metricPosition==v.FQ.PREVIOUS_WEEK?n=p.Ru.get("ui.label.time.lastweekSameDay"):t.setting.metricPosition==v.FQ.YESTERDAY?n=p.Ru.get("ui.label.time.yesterday"):t.setting.metricPosition==v.FQ.ONE_MINUTE_AGO?n=p.Ru.get("word.lastMinutes",1):t.setting.metricPosition==v.FQ.FIVE_MINUTE_AGO?n=p.Ru.get("word.lastMinutes",5):t.setting.metricPosition==v.FQ.TEN_MINUTE_AGO?n=p.Ru.get("word.lastMinutes",10):n=`${p.Ru.get("ui.label.custom")} (${(0,K.qm)(t.setting.customCompareDate).format("YYYY-MM-DD")})`,`${s} ${i} ${n} * ${t.setting.basePercent}%`}function de(t){const s={...v.t7};return(0,p.hU)(t===v.W5.INSTANCE?v.qX:v.Ru).map(i=>({text:p.Ru.get(`ui.mx.${i.toLowerCase()}`),value:s[i.toLowerCase()]}))}function ve(){return[{text:">",value:v.hm.GREATER_THAN},{text:"<",value:v.hm.SMALLER_THAN}]}function ge(){return[{text:p.Ru.get("ui.label.time.lastweekSameDay"),value:v.FQ.PREVIOUS_WEEK},{text:p.Ru.get("ui.label.time.yesterday"),value:v.FQ.YESTERDAY},{text:p.Ru.get("word.lastMinutes",[1]),value:v.FQ.ONE_MINUTE_AGO},{text:p.Ru.get("word.lastMinutes",[5]),value:v.FQ.FIVE_MINUTE_AGO},{text:p.Ru.get("word.lastMinutes",[10]),value:v.FQ.TEN_MINUTE_AGO},{text:p.Ru.get("ui.label.custom"),value:v.FQ.CUSTOM_DATE}]}function qt(t){return`${t<10?"0":""}${t}`}function x(t,s){return t.findIndex(i=>i.domainId===s.domainId&&i.setting.gtype===s.setting.gtype&&i.setting.eventLevel===s.setting.eventLevel&&i.setting.metricId===s.setting.metricId&&i.setting.metricComparator===s.setting.metricComparator&&i.setting.metricPosition===s.setting.metricPosition&&i.setting.filterMetricId===s.setting.filterMetricId)}const T={SELECT_ITEM:"selectSettingItem",RESET_ITEMS:"resetSettingItems",ADD_ITEMS:"addSettingItems",DELETE_ITEM:"deleteSettingItem",CHANGE_FILTER_TYPE:"changeFilterType",SET_USE_LOADING:"setUseLoading",CHANGE_SCREEN_MODE:"changeScreenMode",UPDATE_CHECKED_ITEMS:"updateCheckedSettingItems"},S={LOAD_METRICS_TYPES:"loadMetricsTypes",LOAD_ITEMS:"loadSettingItems",SAVE_ITEM:"saveSettingItem",DELETE_ITEM:"deleteSettingItem",DELETE_ITEMS:"deleteSettingItems",COPY_ITEMS:"copySettingItems"},fe={namespaced:!0,state:()=>({module:"comparisonInRule",screenMode:"list",items:[],checkedItems:[],filterType:-1,useLoading:!1,selectedItem:{domainId:-1,fullName:"",setting:ae()}}),mutations:{[T.CHANGE_SCREEN_MODE](t,s){t.screenMode=s,s!=="modify"&&(t.selectedItem={domainId:-1,fullName:"",setting:ae()})},[T.ADD_ITEMS](t,s){t.items=[...t.items,...s]},[T.DELETE_ITEM](t,s){const i=x(t.items,s);t.items=t.items.filter((n,d)=>d!==i)},[T.RESET_ITEMS](t){t.items=[]},[T.CHANGE_FILTER_TYPE](t,s){t.filterType=s},[T.SET_USE_LOADING](t,s){t.useLoading=s},[T.SELECT_ITEM](t,s){t.screenMode="modify",t.selectedItem=s},[T.UPDATE_CHECKED_ITEMS](t,s){t.checkedItems=s}},actions:{async[S.LOAD_ITEMS]({state:t,commit:s},i){s(T.SET_USE_LOADING,!0);const n=t.filterType===-1?[100,103]:[t.filterType];for(let d=0;d<n.length;d++){const{data:I}=await U.A.get("/eventRule/intelli/metrics/list",{params:{format:"json",sid:i.domainId,gtype:n[d]}});s(T.ADD_ITEMS,I.map(g=>{const f=g.customCompareDateOrNull,l=g.customMessageOrEmpty;return{domainId:i.domainId,fullName:i.fullName,setting:{...g,customMessage:l,customCompareDate:f===null?(0,K.qm)().format("YYYYMMDD"):f}}}))}s(T.SET_USE_LOADING,!1)},async[S.SAVE_ITEM]({dispatch:t},s){const i=(0,p.hU)(v.hm),n=(0,p.hU)(v.FQ),d=await t(S.DELETE_ITEM,s);return d.data?await U.A.post("/eventRule/intelli/metrics/set",(0,p.$W)({sid:s.domainId,...s.setting,metricComparator:i[s.setting.metricComparator],metricPosition:n[s.setting.metricPosition]})):d},async[S.COPY_ITEMS]({state:t,commit:s,dispatch:i},n){for(let d=0;d<n.length;d++){const I={...t.selectedItem.setting};await i(S.SAVE_ITEM,{domainId:n[d],fullName:t.selectedItem.fullName,setting:I})}},async[S.DELETE_ITEM]({},t){const s=(0,p.hU)(v.hm),i=(0,p.hU)(v.FQ);return await U.A.post("/eventRule/intelli/metrics/delete",(0,p.$W)({sid:t.domainId,gtype:t.setting.gtype,eventLevel:t.setting.eventLevel,metricId:t.setting.metricId,metricComparator:s[t.setting.metricComparator],metricPosition:i[t.setting.metricPosition],filterMetricId:t.setting.filterMetricId}))},async[S.DELETE_ITEMS]({state:t,commit:s,dispatch:i}){for(let n=0;n<t.checkedItems.length;n++){const{data:d}=await i(S.DELETE_ITEM,t.checkedItems[n]);d&&s(T.DELETE_ITEM,t.checkedItems[n])}}}};G.A.hasModule("comparisonInRule")||G.A.registerModule("comparisonInRule",fe);const xt=null,_e={class:"card"},Ce={class:"row"},Ee={class:"left"},Te={class:"subject"},ye=["innerHTML"],Ie={class:"value",style:{"margin-top":"8px"}},Me={class:"right"},Le={class:"subject"},De={class:"value",style:{"margin-top":"8px"}},ke={class:"component"},Ae={class:"row"},he={class:"column"},be={class:"subject"},We={class:"value"},Se={class:"column"},we={class:"subject"},Fe={class:"value"},Re={key:0,class:"row"},Ne={class:"subject"},Pe={class:"value"},Oe={class:"checkbox"};function Be(t,s,i,n,d,I){const g=(0,e.g2)("toggle-switch"),f=(0,e.g2)("event-level"),l=(0,e.g2)("memo"),L=(0,e.g2)("checkbox");return(0,e.uX)(),(0,e.CE)("div",_e,[(0,e.Lk)("div",{class:"rows",onClick:s[0]||(s[0]=(0,e.D$)((...w)=>t.onClickCard&&t.onClickCard(...w),["prevent"]))},[(0,e.Lk)("div",Ce,[(0,e.Lk)("div",Ee,[(0,e.Lk)("div",Te,[(0,e.Lk)("span",{innerHTML:t.item.fullName},null,8,ye),s[2]||(s[2]=(0,e.eW)()),(0,e.Lk)("div",Ie,[(0,e.Lk)("strong",null,(0,e.v_)(t.settingTitle),1)])])]),s[6]||(s[6]=(0,e.eW)()),(0,e.Lk)("div",Me,[(0,e.Lk)("div",Le,[(0,e.Lk)("span",null,(0,e.v_)(t.i18n.targetType),1),s[3]||(s[3]=(0,e.eW)()),(0,e.Lk)("div",De,[(0,e.Lk)("span",null,(0,e.v_)(t.targetTypeName),1)])]),s[5]||(s[5]=(0,e.eW)()),(0,e.Lk)("div",ke,[(0,e.Lk)("span",null,(0,e.v_)(t.i18n.instanceGlobalRule),1),s[4]||(s[4]=(0,e.eW)()),(0,e.bF)(g,{active:t.item.setting.applied,onChange:t.onChangeApplied},null,8,["active","onChange"])])])]),s[8]||(s[8]=(0,e.eW)()),(0,e.Lk)("div",Ae,[(0,e.Lk)("div",he,[(0,e.Lk)("div",be,[(0,e.eW)((0,e.v_)(t.i18n.eventLevel)+" ",1),(0,e.Lk)("div",We,[(0,e.bF)(f,{large:"",level:t.item.setting.eventLevel},null,8,["level"])])])]),s[7]||(s[7]=(0,e.eW)()),(0,e.Lk)("div",Se,[(0,e.Lk)("div",we,[(0,e.eW)((0,e.v_)(t.i18n.eventRollback)+" ",1),(0,e.Lk)("div",Fe,(0,e.v_)(t.item.setting.iconRecoveryTime/1e3)+(0,e.v_)(t.i18n.second),1)])])]),s[9]||(s[9]=(0,e.eW)()),t.item.setting.filterApplied?((0,e.uX)(),(0,e.CE)("div",Re,[(0,e.Lk)("div",Ne,[(0,e.eW)((0,e.v_)(t.i18n.filterCondition)+" ",1),(0,e.Lk)("div",Pe,[(0,e.bF)(l,{"memo-type":"normal","memo-text":{main:t.getMetricsName(t.item.setting.filterMetricId),sub:`${t.i18n.minValue} ${t.item.setting.filterValue}`},"use-sub-text":!0},null,8,["memo-text"])])])])):(0,e.Q3)("v-if",!0)]),s[10]||(s[10]=(0,e.eW)()),(0,e.Lk)("div",Oe,[(0,e.bF)(L,{active:t.checked,onChange:s[1]||(s[1]=w=>t.$emit("check",w))},null,8,["active"])])])}var me=o(88994),ue=o(80805),$e=o(88595),Ue=o(78496);const Ke=(0,e.pM)({components:{ToggleSwitch:ue.A,EventLevel:$e.A,Memo:Ue.A,Checkbox:me.A},props:{item:{type:Object,required:!0},checked:{type:Boolean,required:!0}},emits:["select","active","check"],setup(t,{emit:s}){const i=(0,e.WQ)("i18n",{lastweekSameDay:"",yesterday:"",lastOneMinute:"",lastFiveMinute:"",lastTenMinute:""}),n=(0,e.lW)(t,"item"),d=l=>{l.target.className==="button"||l.target.className.includes("aries-switch")||s("select",n.value)},I=l=>{n.value.setting.applied=l,s("active",n.value)},g=le(n.value),f=pe(n.value.setting.gtype);return{i18n:i,item:n,settingTitle:g,targetTypeName:f,getMetricsName:re,onChangeApplied:I,onClickCard:d}}});var V=o(35339);const He=(0,V.A)(Ke,[["render",Be],["__scopeId","data-v-06e3ec42"]]),Ye=(0,e.pM)({components:{Card:He},emits:["select-item"],setup(t,{emit:s}){const i=(0,e.WQ)("i18n",{}),n=(0,m.P)("domain"),d=(0,e.EW)(()=>n.getters("sidList")),{fullName:I,setFullName:g}=(0,W.bs)(n.state.domainList),{state:f,commit:l,dispatch:L}=(0,m.P)("comparisonInRule"),w=(0,e.EW)(()=>f.items),u=k=>{l(T.SELECT_ITEM,k),s("select-item",k)},P=async k=>{await L(S.SAVE_ITEM,k)},N=(k,z)=>{if(z)l(T.UPDATE_CHECKED_ITEMS,[...f.checkedItems,k]);else{const J=x(f.checkedItems,k);l(T.UPDATE_CHECKED_ITEMS,f.checkedItems.filter((j,Z)=>Z!==J))}},y=k=>x(f.checkedItems,k)!==-1;return(0,e.nT)(()=>{l(T.RESET_ITEMS),d.value.forEach(k=>{g(k),L(S.LOAD_ITEMS,{fullName:(0,e.tB)(I).value,domainId:k})})}),{i18n:i,cardItems:w,onClickCardItem:u,onClickActiveCardItem:P,onCheckCardItem:N,isChecked:y}}}),Qe=(0,V.A)(Ye,[["render",E]]),Ge={class:"card-form"},Xe={class:"row"},je={class:"left"},Ve={class:"right"},ze={class:"row"},Je={class:"right full-name"},Ze=["innerHTML"],qe=["innerHTML"],xe={class:"row"},et={class:"left"},tt={class:"right"},st={class:"row"},nt={class:"left"},ot={class:"right"},it={class:"col-group"},at={class:"col"},rt={class:"sub-title"},lt={class:"col"},dt={class:"sub-title"},mt={class:"col-group"},ut={class:"col"},ct={class:"sub-title"},pt={class:"col-group"},vt={class:"col"},gt={class:"sub-title"},ft={class:"col-group"},_t={class:"col"},Ct={class:"sub-title"},Et=["readonly"],Tt={class:"col-group"},yt={class:"col"},It={class:"sub-title"},Mt={class:"col-group"},Lt={class:"col"},Dt={class:"sub-title"},kt={class:"col"},At={class:"sub-title"},ht={class:"col-group"},bt={class:"message"},Wt={class:"footer"};function St(t,s,i,n,d,I){const g=(0,e.g2)("target-type-dropdown"),f=(0,e.g2)("toggle-switch"),l=(0,e.g2)("dropdown"),L=(0,e.g2)("format-number-input"),w=(0,e.g2)("format-date-input"),u=(0,e.g2)("checkbox"),P=(0,e.g2)("btn"),N=(0,e.g2)("alert-window");return(0,e.uX)(),(0,e.CE)("div",Ge,[(0,e.Lk)("div",Xe,[(0,e.Lk)("div",je,(0,e.v_)(t.i18n.targetType),1),s[5]||(s[5]=(0,e.eW)()),(0,e.Lk)("div",Ve,[(0,e.bF)(g,{"is-new":t.isNew,"group-type":t.formData.setting.gtype,onChange:t.onChangeTargetType},null,8,["is-new","group-type","onChange"])])]),s[32]||(s[32]=(0,e.eW)()),(0,e.Lk)("div",ze,[(0,e.Lk)("div",Je,[t.isNew?((0,e.uX)(),(0,e.CE)("div",{key:0,innerHTML:t.fullName},null,8,Ze)):((0,e.uX)(),(0,e.CE)("div",{key:1,innerHTML:t.formData.fullName},null,8,qe))])]),s[33]||(s[33]=(0,e.eW)()),(0,e.Lk)("div",xe,[(0,e.Lk)("div",et,(0,e.v_)(t.i18n.instanceGlobalRule),1),s[6]||(s[6]=(0,e.eW)()),(0,e.Lk)("div",tt,[(0,e.bF)(f,{normal:"",active:t.formData.setting.applied,"onUpdate:active":s[0]||(s[0]=y=>t.formData.setting.applied=y)},null,8,["active"])])]),s[34]||(s[34]=(0,e.eW)()),(0,e.Lk)("div",st,[(0,e.Lk)("div",nt,(0,e.v_)(t.i18n.setting),1),s[30]||(s[30]=(0,e.eW)()),(0,e.Lk)("div",ot,[(0,e.Lk)("div",it,[(0,e.Lk)("div",at,[(0,e.Lk)("div",rt,(0,e.v_)(t.i18n.eventLevel),1),s[7]||(s[7]=(0,e.eW)()),(0,e.bF)(l,{normal:"",items:t.eventLevelItems,width:250,"selected-value":t.formData.setting.eventLevel,disabled:!t.activeRequiredForm,onOnchange:t.onChangeEventLevel},null,8,["items","selected-value","disabled","onOnchange"])]),s[9]||(s[9]=(0,e.eW)()),(0,e.Lk)("div",lt,[(0,e.Lk)("div",dt,(0,e.v_)(t.i18n.eventRollback),1),s[8]||(s[8]=(0,e.eW)()),(0,e.bF)(L,{width:100,value:t.iconRecoveryTime,min:10,disabled:!t.formData.setting.applied,onInput:t.onInputIconRecoveryTime},null,8,["value","disabled","onInput"]),(0,e.eW)(" "+(0,e.v_)(t.i18n.second),1)])]),s[22]||(s[22]=(0,e.eW)()),(0,e.Lk)("div",mt,[(0,e.Lk)("div",ut,[(0,e.Lk)("div",ct,(0,e.v_)(t.i18n.metrics),1),s[10]||(s[10]=(0,e.eW)()),(0,e.bF)(l,{normal:"",items:t.metricsTypeItems,"selected-value":t.formData.setting.metricId,width:250,disabled:!t.activeRequiredForm,onOnchange:t.onChangeMetricsId},null,8,["items","selected-value","disabled","onOnchange"])])]),s[23]||(s[23]=(0,e.eW)()),(0,e.Lk)("div",pt,[(0,e.Lk)("div",vt,[(0,e.Lk)("div",gt,(0,e.v_)(t.i18n.rule),1),s[11]||(s[11]=(0,e.eW)()),(0,e.bF)(l,{normal:"",width:60,items:t.metricsComparatorItems,"selected-value":t.formData.setting.metricComparator,disabled:!t.activeRequiredForm,onOnchange:t.onChangeMetricsComparator},null,8,["items","selected-value","disabled","onOnchange"]),s[12]||(s[12]=(0,e.eW)()),(0,e.bF)(l,{normal:"",width:148,items:t.metricsPositionItems,"selected-value":t.formData.setting.metricPosition,disabled:!t.activeRequiredForm,onOnchange:t.onChangeMetricsPosition},null,8,["items","selected-value","disabled","onOnchange"]),s[13]||(s[13]=(0,e.eW)()),t.formData.setting.metricPosition===5?((0,e.uX)(),(0,e.Wv)(w,{key:0,normal:"","hide-time":"",messages:t.componentMessages,time:t.currentTime,disabled:!t.activeRequiredForm,onChange:t.onUpdateCurrentTime},null,8,["messages","time","disabled","onChange"])):(0,e.Q3)("v-if",!0),s[14]||(s[14]=(0,e.eW)()),s[15]||(s[15]=(0,e.Lk)("span",{class:"blank"},"*",-1)),s[16]||(s[16]=(0,e.eW)()),(0,e.bF)(L,{normal:"",width:100,value:t.formData.setting.basePercent,"onUpdate:value":s[1]||(s[1]=y=>t.formData.setting.basePercent=y),disabled:!t.formData.setting.applied},null,8,["value","disabled"]),s[17]||(s[17]=(0,e.eW)(`
                        %
                    `))])]),s[24]||(s[24]=(0,e.eW)()),(0,e.Lk)("div",ft,[(0,e.Lk)("div",_t,[(0,e.Lk)("div",Ct,(0,e.v_)(t.i18n.M0394),1),s[18]||(s[18]=(0,e.eW)()),(0,e.bo)((0,e.Lk)("textarea",{"onUpdate:modelValue":s[2]||(s[2]=y=>t.formData.setting.customMessage=y),readonly:!t.formData.setting.applied},null,8,Et),[[e.Jo,t.formData.setting.customMessage]])])]),s[25]||(s[25]=(0,e.eW)()),s[26]||(s[26]=(0,e.Lk)("div",{class:"splitter"},null,-1)),s[27]||(s[27]=(0,e.eW)()),(0,e.Lk)("div",Tt,[(0,e.Lk)("div",yt,[(0,e.Lk)("div",It,[(0,e.bF)(u,{label:t.i18n.filterCondition,disabled:!t.formData.setting.applied,active:t.formData.setting.filterApplied,"onUpdate:active":s[3]||(s[3]=y=>t.formData.setting.filterApplied=y)},null,8,["label","disabled","active"])])])]),s[28]||(s[28]=(0,e.eW)()),(0,e.Lk)("div",Mt,[(0,e.Lk)("div",Lt,[(0,e.Lk)("div",Dt,(0,e.v_)(t.i18n.metrics),1),s[19]||(s[19]=(0,e.eW)()),(0,e.bF)(l,{normal:"",items:t.metricsTypeItems,"selected-value":t.formData.setting.filterMetricId,width:250,disabled:!t.activeRequiredForm||!t.formData.setting.filterApplied,onOnchange:t.onChangeFilterMetricsId},null,8,["items","selected-value","disabled","onOnchange"])]),s[21]||(s[21]=(0,e.eW)()),(0,e.Lk)("div",kt,[(0,e.Lk)("div",At,(0,e.v_)(t.i18n.minValue),1),s[20]||(s[20]=(0,e.eW)()),(0,e.bF)(L,{width:100,disabled:!t.formData.setting.applied||!t.formData.setting.filterApplied,value:t.formData.setting.filterValue,"onUpdate:value":s[4]||(s[4]=y=>t.formData.setting.filterValue=y)},null,8,["disabled","value"])])]),s[29]||(s[29]=(0,e.eW)()),(0,e.Lk)("div",ht,[(0,e.Lk)("div",bt,(0,e.v_)(t.i18n.M0709),1)])])]),s[35]||(s[35]=(0,e.eW)()),(0,e.Lk)("div",Wt,[(0,e.bF)(P,{class:"border-none",normal:"",items:[{text:t.i18n.cancel}],onClick:t.onClickCancelBtn},null,8,["items","onClick"]),s[31]||(s[31]=(0,e.eW)()),(0,e.bF)(P,{class:"primary",normal:"",items:[{text:t.isNew?t.i18n.add:t.i18n.saveChanges}],onClick:t.onClickSaveBtn},null,8,["items","onClick"])]),s[36]||(s[36]=(0,e.eW)()),t.alertMessage?((0,e.uX)(),(0,e.Wv)(N,{key:0,message:t.alertMessage,onCancel:t.onHideAlertMessage},null,8,["message","onCancel"])):(0,e.Q3)("v-if",!0)])}var wt=o(10991),Ft=o(97953),Rt=o(90194);function Nt(t,s,i,n,d,I){const g=(0,e.g2)("dropdown");return(0,e.uX)(),(0,e.Wv)(g,{normal:"",items:t.targetTypeItems,"selected-value":t.groupType,width:248,disabled:!t.isNew,onOnchange:t.onChangeTargetType},null,8,["items","selected-value","disabled","onOnchange"])}var H=o(73530);const ee=[{text:H.A.viewAll,value:-1},{text:H.A.instance,value:100},{text:H.A.business,value:102},{text:H.A.domain,value:103}],Pt=[{text:H.A.normal,value:1},{text:H.A.warning,value:3},{text:H.A.fatal,value:5}],Ot=(0,e.pM)({components:{Dropdown:r.A},props:{isNew:{type:Boolean,required:!0},groupType:{type:Number,required:!0}},emits:["change"],setup(t,{emit:s}){const i=({value:n})=>{s("change",n)};return{targetTypeItems:[ee[1],ee[3]],groupType:(0,e.lW)(t,"groupType"),onChangeTargetType:i}}}),Bt=(0,V.A)(Ot,[["render",Nt]]);var $t=o(74399),te=o(79526),Ut=o(44399),Kt=o(57222);const Ht=(0,e.pM)({components:{Checkbox:me.A,FormatNumberInput:Ft.A,Btn:h.A,Dropdown:r.A,ToggleSwitch:ue.A,AlertWindow:Rt.A,TargetTypeDropdown:Bt,FormatDateInput:$t.A},props:{isNew:{type:Boolean,required:!0}},emits:["cancel"],setup(t,{emit:s}){const i=(0,m.P)("domain"),{state:n,dispatch:d}=(0,m.P)("comparisonInRule"),I=(0,e.WQ)("i18n",{M0288:"Select a domain.",M0601:"This setting already exists.",M0035:"The rule setting is incorrect."}),g=(0,e.KR)(""),f=(0,e.EW)(()=>n.items),l=(0,e.KR)(de(n.selectedItem.setting.gtype)),L=(0,e.KR)(ve()),w=(0,e.KR)(ge()),u=(0,e.Kh)({domainId:t.isNew?i.state.selectedOne.data.sid:n.selectedItem.domainId,fullName:n.selectedItem.fullName,setting:{...n.selectedItem.setting,metricId:t.isNew?l.value[0].value:n.selectedItem.setting.metricId,filterMetricId:t.isNew?l.value[0].value:n.selectedItem.setting.filterMetricId}}),P=(0,e.EW)(()=>t.isNew&&u.setting.applied),N=(0,e.KR)((0,wt.VP)(t.isNew?(0,K.qm)():(0,K.qm)(n.selectedItem.setting.customCompareDate),"date")),y=(0,e.KR)(u.setting.iconRecoveryTime/1e3),{fullName:k,setFullName:z}=(0,W.bs)(i.state.domainList);z(u.domainId);const J=_=>{u.setting.gtype=_,l.value=de(_)},j=({value:_})=>{u.setting.eventLevel=_},Z=({value:_})=>{u.setting.metricId=_},se=({value:_})=>{u.setting.filterMetricId=_},ne=({value:_})=>{u.setting.metricComparator=_},Y=({value:_})=>{u.setting.metricPosition=_},ce=_=>{u.setting.iconRecoveryTime=_*1e3,y.value=_},zt=_=>{N.value=_,u.setting.customCompareDate=_.format("YYYYMMDD")},Jt=async()=>{if(t.isNew&&f.value.filter(X=>X.domainId===u.domainId&&X.setting.metricId===u.setting.metricId&&X.setting.eventLevel===u.setting.eventLevel&&X.setting.metricComparator===u.setting.metricComparator&&X.setting.metricPosition===u.setting.metricPosition&&X.setting.filterMetricId===u.setting.filterMetricId&&X.setting.gtype===u.setting.gtype).length>0){ie("M0601");return}const{data:_}=await d(S.SAVE_ITEM,u);if(!_){ie("M0035");return}oe()},oe=()=>{s("cancel")},ie=_=>{g.value=I[_]},Zt=()=>{g.value=""};return(0,Kt.v)(()=>{oe()}),{isNew:(0,e.lW)(t,"isNew"),helpIconOptions:{type:te.B2.help,size:16},eventLevelItems:Pt,componentMessages:Ut.Ay,currentTime:N,metricsTypeItems:l,metricsComparatorItems:L,metricsPositionItems:w,i18n:I,formData:u,iconRecoveryTime:y,alertMessage:g,activeRequiredForm:P,fullName:k,onChangeTargetType:J,onChangeEventLevel:j,onChangeMetricsId:Z,onChangeFilterMetricsId:se,onChangeMetricsComparator:ne,onChangeMetricsPosition:Y,onInputIconRecoveryTime:ce,onUpdateCurrentTime:zt,onClickSaveBtn:Jt,onClickCancelBtn:oe,onShowAlertMessage:ie,onHideAlertMessage:Zt}}}),Yt=(0,V.A)(Ht,[["render",St],["__scopeId","data-v-0e3fa770"]]);var Qt=o(61997),Gt=o(10935),Xt=o(52004);const jt=(0,e.pM)({components:{Btn:h.A,LoadingIndicator:a.A,Dropdown:r.A,DomainTreeLayer:M.A,BaseHeader:D.A,Cards:Qe,CardForm:Yt,DomainWindow:Qt.A,ConfirmWindow:Gt.A},setup(){(0,e.Gt)("i18n",H.A);const t=(0,m.P)("domain"),s=(0,e.EW)(()=>t.state.selectedOne),{state:i,commit:n,dispatch:d}=(0,m.P)("comparisonInRule"),I=(0,e.EW)(()=>i.useLoading),g=(0,e.EW)(()=>i.screenMode),f=(0,e.EW)(()=>i.filterType),l=(0,e.EW)(()=>i.selectedItem),L=(0,e.EW)(()=>i.checkedItems),w=ee.filter(Y=>Y.text!==H.A.business),u=(0,e.EW)(()=>(0,Xt.oB)(l.value.domainId)),P=(0,e.KR)(!1),N=(0,e.KR)(!1),y=(0,e.KR)(""),k=(0,e.KR)(window.innerWidth>1280),z=Y=>{n(T.CHANGE_FILTER_TYPE,Y.value)},J=()=>{n(T.CHANGE_SCREEN_MODE,"write")},j=()=>{n(T.CHANGE_SCREEN_MODE,"list")},Z=async()=>{const{data:Y}=await d(S.DELETE_ITEM,l.value);Y&&j()},se=()=>{d(S.DELETE_ITEMS),y.value=""},ne=async Y=>{N.value=!0;try{await d(S.COPY_ITEMS,Y)}catch{}finally{N.value=!1,P.value=!1,j()}};return(0,e.wB)(s,()=>{g.value!=="list"&&n(T.CHANGE_SCREEN_MODE,"list")}),{i18nMessages:H.A,iconTypes:{trashcan:te.B2.trashcan,add:te.B2.add},filteredTargetItems:w,useLoading:I,screenMode:g,filterType:f,selectedItem:l,checkedItems:L,domains:u,activeDomainWindow:P,copyLoading:N,confirmMessage:y,selectedDomain:s,showDomainTreeLayer:k,onCopyDomainSettings:ne,createTitle:le,onClickAddSetting:J,onChangeFilterType:z,onClickDeleteSetting:Z,onClickDeleteSettings:se,onClickBackBtn:j}}}),Vt=(0,V.A)(jt,[["render",R]])},78496:(q,O,o)=>{o.d(O,{A:()=>h});var e=o(47577);const b={class:"main"};function B(a,r,M,D,C,c){const E=(0,e.g2)("svg-icon"),W=(0,e.g2)("tooltip");return(0,e.uX)(),(0,e.Wv)(W,{position:"top-center",message:`${a.memoText.main}`},{default:(0,e.k6)(()=>[(0,e.Lk)("div",{class:(0,e.C4)(["memo",a.memoType,a.memoText.disabled?"disabled":"",a.memoText.active?"active":""]),onClick:r[1]||(r[1]=(...m)=>a.onClickMemo&&a.onClickMemo(...m))},[(0,e.Lk)("span",b,(0,e.v_)(a.memoText.main),1),r[4]||(r[4]=(0,e.eW)()),a.useSubText?((0,e.uX)(),(0,e.CE)(e.FK,{key:0},[r[2]||(r[2]=(0,e.Lk)("span",{class:"blank"},":",-1)),r[3]||(r[3]=(0,e.eW)()),(0,e.Lk)("strong",null,(0,e.v_)(a.memoText.sub),1)],64)):(0,e.Q3)("v-if",!0),r[5]||(r[5]=(0,e.eW)()),a.useDeleteBtn&&!a.memoText.disabled?((0,e.uX)(),(0,e.CE)("div",{key:1,class:"icon",onClick:r[0]||(r[0]=(0,e.D$)((...m)=>a.onClickDeleteBtn&&a.onClickDeleteBtn(...m),["prevent","stop"]))},[(0,e.bF)(E,{icon:a.iconType,width:a.iconSize,height:a.iconSize},null,8,["icon","width","height"])])):(0,e.Q3)("v-if",!0)],2)]),_:1},8,["message"])}var F=o(79526),$=o(8355);const Q=(0,e.pM)({components:{SvgIcon:F.Ah,Tooltip:$.A},props:{memoType:{type:String,required:!0},memoText:{type:Object,required:!0},useSubText:{type:Boolean,required:!1,default:!1},useDeleteBtn:{type:Boolean,required:!1,default:!1},iconSize:{type:Number,required:!1,default:16}},emits:["delete","select"],setup(a,{emit:r}){const M=()=>{r("select",a.memoText)},D=()=>{r("delete",a.memoText)};return{iconType:F.B2.close,onClickMemo:M,onClickDeleteBtn:D,...(0,e.QW)(a)}}});var A=o(35339);const h=(0,A.A)(Q,[["render",B],["__scopeId","data-v-072375bf"]])}}]);
