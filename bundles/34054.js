"use strict";(self.webpackChunkjennifer5_frontend=self.webpackChunkjennifer5_frontend||[]).push([[34054],{3280:(C,f,s)=>{s.d(f,{X:()=>v});var e=s(47577);const m={class:"popup-and-button-wrapper"},g={class:"popup-window-container"};function v(T,_,r,p,i,t){const o=(0,e.g2)("Icon"),n=(0,e.g2)("resource-selector"),a=(0,e.g2)("window"),l=(0,e.g2)("fade-down"),d=(0,e.gN)("click-outside");return(0,e.bo)(((0,e.uX)(),(0,e.CE)("div",m,[(0,e.Lk)("button",{ref:"popup-button",class:"jui-ish-button",onClick:_[0]||(_[0]=(...c)=>t.buttonClickHandler&&t.buttonClickHandler(...c))},[(0,e.eW)((0,e.v_)(t.i18n.targetConfig)+" ",1),r.useButtonIcon?((0,e.uX)(),(0,e.CE)(e.FK,{key:0},[_[3]||(_[3]=(0,e.eW)(`
                :
                `)),(0,e.bF)(o,{"style-override":"position: relative; top:3px;","resource-type":i.selectedResourceType},null,8,["resource-type"]),(0,e.eW)(" "+(0,e.v_)(t.selectedResourceText),1)],64)):(0,e.Q3)("v-if",!0)],512),_[5]||(_[5]=(0,e.eW)()),(0,e.bF)(l,null,{default:(0,e.k6)(()=>[i.open?((0,e.uX)(),(0,e.Wv)(a,{key:0,messages:t.messagesForWindow,"open-x":i.openX,"onUpdate:openX":_[1]||(_[1]=c=>i.openX=c),"open-y":i.openY,"onUpdate:openY":_[2]||(_[2]=c=>i.openY=c),"open-w":t.prettyWidth,"open-h":540,onApply:t.submitNManualChecked,onCancel:t.cancelHandler},{subject:(0,e.k6)(()=>[(0,e.Lk)("span",null,(0,e.v_)(t.i18n.targetConfig),1)]),default:(0,e.k6)(()=>[_[4]||(_[4]=(0,e.eW)()),(0,e.Lk)("div",g,[(0,e.bF)(n,{tab:i.currentTab,resources:i.currentResources,"no-border":!1,"show-resource-type-tab":!1,onTabChange:t.tabChangeHandler,onResourceChange:t.resourceChangeHandler},null,8,["tab","resources","onTabChange","onResourceChange"])])]),_:1,__:[4]},8,["messages","open-x","open-y","open-w","onApply","onCancel"])):(0,e.Q3)("v-if",!0)]),_:1})])),[[d,t.onClickOutside]])}},3515:(C,f,s)=>{s.d(f,{A:()=>o});var e=s(47577);const m={class:"memos"},g={class:"title"},v={key:0,class:"separator"},T={class:"list"};function _(n,a,l,d,c,h){const u=(0,e.g2)("memo-comp");return(0,e.uX)(),(0,e.CE)("div",m,[(0,e.Lk)("div",g,(0,e.v_)(n.subject),1),a[0]||(a[0]=(0,e.eW)()),n.useSeparator?((0,e.uX)(),(0,e.CE)("div",v)):(0,e.Q3)("v-if",!0),a[1]||(a[1]=(0,e.eW)()),(0,e.Lk)("div",T,[n.memoItems.length>0?((0,e.uX)(!0),(0,e.CE)(e.FK,{key:0},(0,e.pI)(n.memoItems,(R,E)=>((0,e.uX)(),(0,e.Wv)(u,{key:E,"memo-type":n.memoType,"memo-text":R,"use-sub-text":n.useSubText,"icon-size":n.iconSize,"use-delete-btn":"",onDelete:A=>n.onDeleteMemo(R,E),onSelect:A=>n.onSelectMemo(R,E)},null,8,["memo-type","memo-text","use-sub-text","icon-size","onDelete","onSelect"]))),128)):(0,e.Q3)("v-if",!0)])])}var r=s(78496);const p=(0,e.pM)({components:{MemoComp:r.A},props:{subject:{type:String,required:!0},memoType:{type:String,required:!1,default:"normal"},memoItems:{type:Array,required:!0},useSubText:{type:Boolean,required:!1,default:!1},useSeparator:{type:Boolean,required:!1,default:!0},iconSize:{type:Number,required:!1,default:16}},emits:["delete","select"],setup(n,{emit:a}){return{i18n:(0,e.WQ)("i18n",{}),onSelectMemo:(h,u)=>{a("select",h,u)},onDeleteMemo:(h,u)=>{a("delete",h,u)},...(0,e.QW)(n)}}});var i=s(35339);const o=(0,i.A)(p,[["render",_],["__scopeId","data-v-38678256"]])},15114:(C,f,s)=>{s.d(f,{A:()=>T});var e=s(30556),m=s(64173),g=s(35339);const T=(0,g.A)(m.A,[["render",e.X],["__scopeId","data-v-6fb6a6c3"]])},18697:(C,f,s)=>{s.d(f,{A:()=>_});var e=s(43866),m=s(67281),g=s(59775),v=s(74986),T=s(48414);const _={inject:{i18n:{default:{targetConfig:"Select targets",cancel:"Cancel",submit:"Finish",autoRefresh:"Auto Refresh"}}},components:{ResourceSelector:e.A,Window:m.A,FadeDown:g.A,Icon:v.A},directives:{clickOutside:T.A},props:{checkedCache:{type:Boolean,default:!1},resources:{type:Array,required:!0},popupPositionLeft:{type:Boolean,default:!1},distTop:{type:Number,default:0},defaultSelectedResourceIndex:{type:Number,default:0,validator(r){return r>=0||r<this.resources.length}},useButtonIcon:{type:Boolean,required:!1,default:!0}},data(){return{open:!1,openX:0,openY:0,currentTab:this.resources[this.defaultSelectedResourceIndex].resourceType,selectedResourceType:this.resources[this.defaultSelectedResourceIndex].resourceType,currentResources:[],selectedResources:[],manualCheckedResources:[]}},computed:{prettyWidth(){return this.resources.length===2?354:380},messagesForWindow(){return{apply:this.i18n.submit,cancel:this.i18n.cancel}},selectedResourceText(){return(0,e.Z)(this.selectedResourceType)},checkedResources(){return this.selectedResources.find(r=>r.resourceType===this.selectedResourceType).tree.filter(r=>r.check==="on")}},watch:{resources:{handler(r){this.currentTab=r[this.defaultSelectedResourceIndex].resourceType,this.selectedResourceType=r[this.defaultSelectedResourceIndex].resourceType,this.manualCheckedResources.length>0&&this.checkedCache&&r.forEach(p=>{p.tree=p.tree?.map(i=>{const{sid:t,oid:o}=i.data;return i.check=this.manualCheckedResources.findIndex(n=>n.data.sid===t&&n.data.oid===o)>-1?"on":"off",i})}),this.currentResources=Array.from(r),this.selectedResources=Array.from(r),this.submitHandler()},deep:!1}},mounted(){this.updateButtonXY()},methods:{updateButtonXY(){const{top:r,height:p,left:i,width:t}=this.$refs["popup-button"].getBoundingClientRect();this.openY=r+p+8+this.distTop,this.popupPositionLeft?this.openX=i:this.openX=i-this.prettyWidth+t},buttonClickHandler(){this.open||this.updateButtonXY(),this.open=!this.open,this.$emit("buttonClick",this.open)},cancelHandler(){this.open=!1,setTimeout(()=>{this.currentTab=this.selectedResourceType,this.currentResources=Array.from(this.selectedResources)},150)},submitNManualChecked(){this.submitHandler(),this.checkedCache&&(this.manualCheckedResources=this.checkedResources)},submitHandler(){this.open=!1,this.selectedResourceType=this.currentTab,this.selectedResources=Array.from(this.currentResources),this.$emit("submit",{resourceType:this.selectedResourceType,tree:this.checkedResources})},tabChangeHandler(r){this.currentTab=r,this.resourceChangeHandler({resourceType:r,tree:this.currentResources.find(({resourceType:p})=>p===r).tree})},resourceChangeHandler({resourceType:r,tree:p}){this.currentTab=r;const i=this.currentResources.findIndex(t=>t.resourceType===r);this.currentResources[i]={...this.currentResources[i],tree:p}},onClickOutside(){this.open&&(this.open=!1)},clearManualCheckedResources(){this.manualCheckedResources=[]}}}},28416:(C,f,s)=>{s.d(f,{MJ:()=>i,bs:()=>r,cl:()=>_});var e=s(86617),m=s(47577),g=s(27664),v=s(73529),T=s(95447);function _(t){const o=new Map,n=new Map;t.forEach(d=>{o.set(d.treeIndex,d),d.data.sid!==-1&&n.set(d.data.sid,d.treeIndex)});const a=(0,m.KR)([]),l=d=>{const c=n.get(d);if(typeof c!="string")return"";const h=[],u=c.split(".");for(;u.length>0;){const R=o.get(u.join("."));R&&(h.push(R.label),u.pop())}a.value=[...h]};return{parentNames:(0,m.tB)(a),setParentNames:l}}function r(t){const{parentNames:o,setParentNames:n}=_(t),a=(0,m.KR)(""),l=d=>{n(d);const c=[...o.value],h=c.shift();a.value=(c.length>0?c.reverse().join(" / ")+" / ":"")+`<strong>${h}</strong>`};return{fullName:(0,m.tB)(a),setFullName:l}}function p(t){const o=t.filter(l=>l.resourceType==="domain"),n=ref(o[0]);return{selectedDomain:n,setSelectedDomain:l=>{n.value=o.filter(d=>d.data.sid===l)[0]}}}function i(t=-1,o,n,a){const l=(0,g.qm)(),d=(0,m.KR)([{resourceType:"instance",tree:[]}]),c=u=>v.cw.get([u],l.valueOf()-1e3*60*60*24,l.valueOf()).then(R=>{const E=R.map(A=>({...A,existData:A.status===e.xr.LIVE})).filter(A=>n===!0?A.existData:!0);d.value=[{resourceType:"instance",tree:Array.from((0,T.XP)(E,"instance"))}]}),h=u=>{const R=d.value[0].tree;d.value=[{resourceType:"instance",tree:R.map(E=>({...E,check:u.includes(E.data[a??"oid"])?"on":"off"}))}]};return t!==-1&&c(t).then(()=>{o&&h(o)}),{resources:d,setResources:c,checkResources:h}}},30556:(C,f,s)=>{s.d(f,{X:()=>e.X});var e=s(3280)},46555:(C,f,s)=>{s.d(f,{A:()=>o});var e=s(47577);const m={class:"instance-setting"},g={class:"subject"};function v(n,a,l,d,c,h){const u=(0,e.g2)("resource-popup"),R=(0,e.g2)("memos");return(0,e.uX)(),(0,e.CE)("div",m,[(0,e.Lk)("div",g,(0,e.v_)(n.description),1),a[0]||(a[0]=(0,e.eW)()),(0,e.bF)(u,{"popup-position-left":"","use-button-icon":!1,resources:n.resources,"dist-top":n.distTop,onSubmit:n.onChangeResources},null,8,["resources","dist-top","onSubmit"]),a[1]||(a[1]=(0,e.eW)()),(0,e.bF)(R,{subject:n.i18n.instances,"memo-items":n.memoItems,onDelete:n.onDeleteInstance,onSelect:n.onSelectInstance},null,8,["subject","memo-items","onDelete","onSelect"])])}var T=s(15114),_=s(3515),r=s(28416);const p=(0,e.pM)({components:{ResourcePopup:T.A,Memos:_.A},props:{description:{type:String,required:!1,default:""},selectedDomainId:{type:Number,required:!0},instanceNames:{type:Array,required:!1,default:()=>[]},instanceOids:{type:Array,required:!1,default:()=>[]},distTop:{type:Number,required:!1,default:0},activeOids:{type:Array,required:!1,default:()=>[]},onlyLiveAgent:{type:Boolean,required:!1,default:!1}},emits:["update:instanceNames","update:instanceOids","change","delete","select"],setup(n,{emit:a}){const{resources:l,setResources:d,checkResources:c}=(0,r.MJ)(n.selectedDomainId,n.instanceOids,n.onlyLiveAgent),h=(0,e.KR)([]);let u=[],R=!1;const E=()=>{const y=[];return n.instanceNames.forEach((b,I)=>{b.startsWith("OID(")&&b.endsWith(")")&&y.push([b,n.instanceOids[I]])}),y},A=y=>{if(R){const b=y.tree;u=b.filter(D=>D.resourceType==="instance"&&D.check==="on"&&D.data.oid!==-1),E().forEach((D,O)=>{u.push({rowId:`row-key-${b.length+O}`,indent:1,label:D[0],resourceType:"instance",check:"on",disabled:!1,showWarningIcon:!1,treeIndex:`0.${b.length+O}`,data:{shortName:D[0],oid:D[1]}})}),M()}R=!0},P=y=>{a("select",y)},k=y=>{u=u.filter(b=>b.data.oid!==y.sub),c(u.map(b=>b.data.oid)),M(),a("delete",y)},M=()=>{const y=u.map(I=>I.data.shortName),b=u.map(I=>I.data.oid);h.value=u.map(I=>({main:I.data.shortName,sub:I.data.oid,disabled:!1,active:n.activeOids.includes(I.data.oid)})),a("update:instanceNames",y),a("update:instanceOids",b),a("change",{names:y,oids:b})};return(0,e.wB)(()=>n.selectedDomainId,(y,b)=>{y!==b&&(R=!1,d(y).then(()=>{c([])}))}),(0,e.wB)(()=>n.activeOids,()=>{h.value=u.map(y=>({main:y.data.shortName,sub:y.data.oid,disabled:!1,active:n.activeOids.includes(y.data.oid)}))}),{i18n:(0,e.WQ)("i18n",{}),memoItems:h,resources:l,onChangeResources:A,onSelectInstance:P,onDeleteInstance:k}}});var i=s(35339);const o=(0,i.A)(p,[["render",v],["__scopeId","data-v-0584c591"]])},57222:(C,f,s)=>{s.d(f,{v:()=>m});var e=s(47577);function m(g){const v=()=>{history.pushState(null,document.title,location.href)},T=()=>{v(),g()};(0,e.KC)(()=>{v(),window.addEventListener("popstate",T)}),(0,e.xo)(()=>{window.removeEventListener("popstate",T)})}},64173:(C,f,s)=>{s.d(f,{A:()=>e.A});var e=s(18697)},73529:(C,f,s)=>{s.d(f,{cw:()=>v});var e=s(21005),m=s(27664);function g(r,p,i){let t=(0,m.qm)(p).second(0).millisecond(0),o=(0,m.qm)(i).second(0).millisecond(0);return{format:"json",sid:r,sids:r,startTime:t.valueOf(),endTime:o.valueOf()}}const v={async get(r,p,i){return e.A.get("/agent/names/tree",{params:g(r,p,i)}).then(t=>{const o=t.data;return Array.isArray(o)?o:[]}).catch(t=>{throw t})}},T={async get(r,p,i){return e.A.get("/biz/group/treeList/tree",{params:g(r,p,i)}).then(t=>{const o=t.data;return Array.isArray(o)?o:[]}).catch(t=>{throw t})}},_=function(r,p,i){const t=new Promise((n,a)=>{v.get(r,p,i).then(l=>{const d=normalizeOidConfigResponse(l,"instance").map(u=>({...u,check:"no-check",selected:!1})),c=d.map(u=>u.resourceType==="domain"?{...u,noInteraction:!0}:u),h=d.filter(u=>u.resourceType==="domain").map(u=>({...u,fold:"no-fold",noFoldPadding:!0}));n([{resourceType:"domain",tree:h},{resourceType:"instance",tree:Array.from(c)}])}).catch(l=>{a(l)})}),o=new Promise((n,a)=>{T.get(r,p,i).then(l=>{const d=normalizeOidConfigResponse(l,"business").map(c=>({...c,check:"no-check",selected:!1})).map(c=>c.resourceType==="domain"?{...c,noInteraction:!0}:c);n([{resourceType:"business",tree:Array.from(d)}])}).catch(l=>{a(l)})});return Promise.all([t,o])}},78496:(C,f,s)=>{s.d(f,{A:()=>i});var e=s(47577);const m={class:"main"};function g(t,o,n,a,l,d){const c=(0,e.g2)("svg-icon"),h=(0,e.g2)("tooltip");return(0,e.uX)(),(0,e.Wv)(h,{position:"top-center",message:`${t.memoText.main}`},{default:(0,e.k6)(()=>[(0,e.Lk)("div",{class:(0,e.C4)(["memo",t.memoType,t.memoText.disabled?"disabled":"",t.memoText.active?"active":""]),onClick:o[1]||(o[1]=(...u)=>t.onClickMemo&&t.onClickMemo(...u))},[(0,e.Lk)("span",m,(0,e.v_)(t.memoText.main),1),o[4]||(o[4]=(0,e.eW)()),t.useSubText?((0,e.uX)(),(0,e.CE)(e.FK,{key:0},[o[2]||(o[2]=(0,e.Lk)("span",{class:"blank"},":",-1)),o[3]||(o[3]=(0,e.eW)()),(0,e.Lk)("strong",null,(0,e.v_)(t.memoText.sub),1)],64)):(0,e.Q3)("v-if",!0),o[5]||(o[5]=(0,e.eW)()),t.useDeleteBtn&&!t.memoText.disabled?((0,e.uX)(),(0,e.CE)("div",{key:1,class:"icon",onClick:o[0]||(o[0]=(0,e.D$)((...u)=>t.onClickDeleteBtn&&t.onClickDeleteBtn(...u),["prevent","stop"]))},[(0,e.bF)(c,{icon:t.iconType,width:t.iconSize,height:t.iconSize},null,8,["icon","width","height"])])):(0,e.Q3)("v-if",!0)],2)]),_:1},8,["message"])}var v=s(79526),T=s(8355);const _=(0,e.pM)({components:{SvgIcon:v.Ah,Tooltip:T.A},props:{memoType:{type:String,required:!0},memoText:{type:Object,required:!0},useSubText:{type:Boolean,required:!1,default:!1},useDeleteBtn:{type:Boolean,required:!1,default:!1},iconSize:{type:Number,required:!1,default:16}},emits:["delete","select"],setup(t,{emit:o}){const n=()=>{o("select",t.memoText)},a=()=>{o("delete",t.memoText)};return{iconType:v.B2.close,onClickMemo:n,onClickDeleteBtn:a,...(0,e.QW)(t)}}});var r=s(35339);const i=(0,r.A)(_,[["render",g],["__scopeId","data-v-072375bf"]])}}]);
