"use strict";(self.webpackChunkjennifer5_frontend=self.webpackChunkjennifer5_frontend||[]).push([[62074],{17513:(an,h,_)=>{_.r(h),_.d(h,{default:()=>qt});var e=_(47577);const P={class:"app-eventctrl"},V={class:"top"},z={key:0,class:"bottom"},J={key:1,class:"bottom"},Y={class:"left"},Z={class:"right"},q={class:"scroll-view"};function x(t,n,l,u,a,d){const r=(0,e.g2)("loading-page"),i=(0,e.g2)("error-type-layer"),p=(0,e.g2)("error-header"),v=(0,e.g2)("domain-list"),o=(0,e.g2)("domain-form");return(0,e.uX)(),(0,e.CE)("div",P,[(0,e.Lk)("div",V,(0,e.v_)(t.i18nMessages.errorTitle),1),n[2]||(n[2]=(0,e.eW)()),t.loadingPercent<100?((0,e.uX)(),(0,e.CE)("div",z,[(0,e.bF)(r,{percent:t.loadingPercent},null,8,["percent"])])):((0,e.uX)(),(0,e.CE)("div",J,[(0,e.Lk)("div",Y,[(0,e.bF)(i)]),n[1]||(n[1]=(0,e.eW)()),(0,e.Lk)("div",Z,[(0,e.bF)(p),n[0]||(n[0]=(0,e.eW)()),(0,e.Lk)("div",q,[t.screenMode==="list"?((0,e.uX)(),(0,e.Wv)(v,{key:0,"domain-list-in-group":t.domainListInGroup},null,8,["domain-list-in-group"])):((0,e.uX)(),(0,e.Wv)(o,{key:1}))])])]))])}const ee={class:"error-type-layer"},te={class:"error-list"},ne=["onClick"];function oe(t,n,l,u,a,d){const r=(0,e.g2)("search");return(0,e.uX)(),(0,e.CE)("div",ee,[(0,e.bF)(r,{placeholder:t.i18n.search2,width:278,value:t.searchKeyword,"onUpdate:value":n[0]||(n[0]=i=>t.searchKeyword=i)},null,8,["placeholder","value"]),n[1]||(n[1]=(0,e.eW)()),(0,e.Lk)("div",te,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(t.errorTypes,(i,p)=>((0,e.uX)(),(0,e.CE)("div",{class:(0,e.C4)(["error",i.key===t.errorType.key?"active":""]),key:p,onClick:v=>t.onClickError(i)},(0,e.v_)(i.key),11,ne))),128))])])}var W=_(86617),E=_(1401),c=_(9438),se=_(6373),ie=_(87469);function F(){return(0,se.hU)(W.i8).map((t,n)=>({key:t,index:n,value:W.i8[t]}))}const ae=(0,e.pM)({components:{Search:ie.A},setup(t){const{state:n,commit:l}=(0,E.P)("errorInRule"),u=(0,e.EW)(()=>n.selectedErrorType),a=(0,e.KR)(F()),d=(0,e.KR)(""),r=i=>{l(c.lL.CHANGE_SCREEN_MODE,"list"),l(c.lL.CHANGE_ERROR_DATA,i)};return(0,e.wB)(d,()=>{d.value===""?a.value=F():a.value=a.value.filter(i=>i.key.includes(d.value.toLocaleUpperCase()))}),l(c.lL.CHANGE_ERROR_DATA,a.value[0]),{i18n:(0,e.WQ)("i18n",{}),searchKeyword:d,errorTypes:a,errorType:u,onClickError:r}}});var f=_(35339);const le=(0,f.A)(ae,[["render",oe],["__scopeId","data-v-126900a9"]]),de={class:"domain-list"},re={class:"group"},ue={key:0,class:"subject"},pe={key:0,class:"name"},_e={class:"parent-names"},ve={class:"name"},me={class:"status"},ce={key:0,class:"active-icon"};function ge(t,n,l,u,a,d){const r=(0,e.g2)("svg-icon"),i=(0,e.g2)("event-level"),p=(0,e.g2)("toggle-switch"),v=(0,e.g2)("setting-table");return(0,e.uX)(),(0,e.CE)("div",de,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(t.domainListInGroup,o=>((0,e.uX)(),(0,e.CE)("div",re,[t.useDomainGroup?((0,e.uX)(),(0,e.CE)("div",ue,[o.isUnknown?((0,e.uX)(),(0,e.CE)("div",pe,(0,e.v_)(t.i18n.unknownGroup),1)):((0,e.uX)(),(0,e.CE)(e.FK,{key:1},[(0,e.Lk)("div",_e,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(o.parentNames,(m,s)=>((0,e.uX)(),(0,e.CE)(e.FK,null,[s<o.parentNames.length-1?((0,e.uX)(),(0,e.CE)(e.FK,{key:0},[(0,e.eW)((0,e.v_)(m)+" ",1),s<o.parentNames.length-2?((0,e.uX)(),(0,e.Wv)(r,{key:0,icon:t.subjectOptions.iconType,width:t.subjectOptions.iconSize,height:t.subjectOptions.iconSize},null,8,["icon","width","height"])):(0,e.Q3)("v-if",!0)],64)):(0,e.Q3)("v-if",!0)],64))),256))]),n[0]||(n[0]=(0,e.eW)()),(0,e.Lk)("div",ve,(0,e.v_)(o.simpleName),1)],64))])):(0,e.Q3)("v-if",!0),n[7]||(n[7]=(0,e.eW)()),(0,e.bF)(v,{columns:t.columns,rows:o.domainList,"min-width":600,selectable:"",onCheck:t.onCheckTableRow,onSelect:t.onSelectTableRow},{row:(0,e.k6)(({data:m,index:s})=>[(0,e.Lk)("td",null,(0,e.v_)(m.shortName),1),n[1]||(n[1]=(0,e.eW)()),(0,e.Lk)("td",me,[t.printColumnValue("individualSetCount",{...m.settingMap[t.errorType.key]})>0?((0,e.uX)(),(0,e.CE)("span",ce)):(0,e.Q3)("v-if",!0)]),n[2]||(n[2]=(0,e.eW)()),(0,e.Lk)("td",null,(0,e.v_)(t.printColumnValue("checkTimeRange",{...m.settingMap[t.errorType.key]},!0)),1),n[3]||(n[3]=(0,e.eW)()),(0,e.Lk)("td",null,(0,e.v_)(t.printColumnValue("thresholdErrorCount",{...m.settingMap[t.errorType.key]})),1),n[4]||(n[4]=(0,e.eW)()),(0,e.Lk)("td",null,(0,e.v_)(t.printColumnValue("iconRecoveryTime",{...m.settingMap[t.errorType.key]},!0)),1),n[5]||(n[5]=(0,e.eW)()),(0,e.Lk)("td",null,[(0,e.bF)(i,{level:t.EventLevelDef[t.printColumnValue("level",{...m.settingMap[t.errorType.key]})]},null,8,["level"])]),n[6]||(n[6]=(0,e.eW)()),(0,e.Lk)("td",null,[(0,e.bF)(p,{small:"",active:t.printColumnValue("applied",{...m.settingMap[t.errorType.key]}),onChange:g=>t.onToggleEventRule(m.sid,{...m.settingMap[t.errorType.key]})},null,8,["active","onChange"])])]),_:2},1032,["columns","rows","onCheck","onSelect"])]))),256))])}var C=_(80805),L=_(79526),ye=_(40317),ke=_(88595);function fe(t){return[{field:"shortName",label:t.domainName,width:"20%"},{field:null,label:t.eventIsIndividualRule},{field:null,label:t.eventCheckTime},{field:null,label:t.eventCriterionTimes},{field:null,label:t.eventRollback},{field:null,label:t.eventLevel},{field:null,label:t.instanceGlobalRule}]}const Se=(0,e.pM)({inject:["i18n"],components:{ToggleSwitch:C.A,SvgIcon:L.Ah,SettingTable:ye.A,EventLevel:ke.A},props:{domainListInGroup:{type:Array,required:!0}},setup(t){const{state:n,commit:l,dispatch:u}=(0,E.P)("errorInRule"),a=(0,e.EW)(()=>n.useDomainGroup),d=(0,e.EW)(()=>n.selectedErrorType),r=(0,e.WQ)("i18n",{second:"sec"}),i=fe(r),p={iconType:L.B2.arrowRight,iconSize:16},v=(g,D,w=!1)=>{const b=D[g];return b!==void 0?w?`${b/1e3}${r.second}`:b:""},o=(g,D)=>{u(c.QN.SAVE_ERROR_ROW_IN_DOMAIN,{domainId:g,instanceIds:[],settingData:{...D,applied:!D.applied}})},m=g=>{l(c.lL.ADD_CHECKED_DOMAIN_IDS,g)},s=async g=>{await u(c.QN.LOAD_EVENT_SETTING_FOR_DOMAIN,{domainName:g.shortName,domainId:g.sid,settingData:{...g.settingMap[d.value.key]}})};return{EventLevelDef:W.s0,i18n:r,columns:i,subjectOptions:p,useDomainGroup:a,errorType:d,domainListInGroup:(0,e.lW)(t,"domainListInGroup"),printColumnValue:v,onToggleEventRule:o,onCheckTableRow:m,onSelectTableRow:s}}}),Ee=(0,f.A)(Se,[["render",ge],["__scopeId","data-v-37b22930"]]),Le={class:"domain-form"},De={class:"row"},We={class:"left"},be={class:"right full-name"},Re=["innerHTML"],Ce={class:"row"},we={class:"left"},Te={class:"right"},Ie={class:"row"},Ae={class:"left"},he={class:"right"},Fe={key:0,class:"row"},Ne={class:"left"},Oe={class:"right"},Me={class:"row"},Be={class:"left"},$e={class:"right"},Xe={class:"footer"};function je(t,n,l,u,a,d){const r=(0,e.g2)("toggle-switch"),i=(0,e.g2)("rule-setting"),p=(0,e.g2)("disk-setting"),v=(0,e.g2)("instance-setting"),o=(0,e.g2)("btn"),m=(0,e.g2)("rule-window");return(0,e.uX)(),(0,e.CE)("div",Le,[(0,e.Lk)("div",De,[(0,e.Lk)("div",We,(0,e.v_)(t.i18n.domain),1),n[1]||(n[1]=(0,e.eW)()),(0,e.Lk)("div",be,[(0,e.Lk)("div",{innerHTML:t.fullName},null,8,Re)])]),n[9]||(n[9]=(0,e.eW)()),(0,e.Lk)("div",Ce,[(0,e.Lk)("div",we,(0,e.v_)(t.i18n.instanceGlobalRule),1),n[2]||(n[2]=(0,e.eW)()),(0,e.Lk)("div",Te,[(0,e.bF)(r,{active:t.formData.settingData.applied,"onUpdate:active":n[0]||(n[0]=s=>t.formData.settingData.applied=s)},null,8,["active"])])]),n[10]||(n[10]=(0,e.eW)()),(0,e.Lk)("div",Ie,[(0,e.Lk)("div",Ae,(0,e.v_)(t.i18n.setting),1),n[3]||(n[3]=(0,e.eW)()),(0,e.Lk)("div",he,[(0,e.bF)(i,{"setting-data":t.formData.settingData},null,8,["setting-data"])])]),n[11]||(n[11]=(0,e.eW)()),t.isDiskErrorType?((0,e.uX)(),(0,e.CE)("div",Fe,[(0,e.Lk)("div",Ne,(0,e.v_)(t.i18n.diskLinkageSetting),1),n[4]||(n[4]=(0,e.eW)()),(0,e.Lk)("div",Oe,[(0,e.bF)(p,{"event-applied":t.formData.settingData.applied,"setting-data":t.diskFormData},null,8,["event-applied","setting-data"])])])):(0,e.Q3)("v-if",!0),n[12]||(n[12]=(0,e.eW)()),(0,e.Lk)("div",Me,[(0,e.Lk)("div",Be,(0,e.v_)(t.i18n.eventSetInvidual),1),n[7]||(n[7]=(0,e.eW)()),(0,e.Lk)("div",$e,[t.foldInstanceSetting?(0,e.Q3)("v-if",!0):((0,e.uX)(),(0,e.Wv)(v,{key:0,description:t.i18n.M0707,"selected-domain-id":t.selectedDomain.data.sid,"instance-names":t.formData.individualSettings.map(s=>s.instanceName),"instance-oids":t.formData.individualSettings.map(s=>s.instanceOid),"active-oids":t.formData.individualSettings.filter(s=>s.applied).map(s=>s.instanceOid),"dist-top":-320,"only-live-agent":!1,onSelect:t.onSelectTargetSetting,onChange:t.onChangeTargetSetting},null,8,["description","selected-domain-id","instance-names","instance-oids","active-oids","onSelect","onChange"])),n[5]||(n[5]=(0,e.eW)()),(0,e.bF)(o,{class:"border-none fold-btn",items:[{iconType:t.iconTypes[t.foldInstanceSetting?"fold":"open"]}],onClick:t.onToggleFoldInstanceSetting,normal:""},null,8,["items","onClick"]),n[6]||(n[6]=(0,e.eW)()),t.targetFormData.instanceName!==""?((0,e.uX)(),(0,e.Wv)(m,{key:1,title:t.targetFormData.instanceName,item:t.targetFormData,onCancel:t.onCancelTargetSettingWindow,onApply:t.onApplyTargetSettingWindow},null,8,["title","item","onCancel","onApply"])):(0,e.Q3)("v-if",!0)])]),n[13]||(n[13]=(0,e.eW)()),(0,e.Lk)("div",Xe,[(0,e.bF)(o,{class:"border-none",normal:"",items:[{text:t.i18n.cancel}],onClick:t.onClickCancelBtn},null,8,["items","onClick"]),n[8]||(n[8]=(0,e.eW)()),(0,e.bF)(o,{class:"primary",normal:"",items:[{text:t.i18n.saveChanges}],onClick:t.onClickSaveBtn},null,8,["items","onClick"])])])}var Ge=_(21005),N=_(35375),Ke=_(46555);const Qe={class:"row"},He={class:"subject"},Ue={class:"row use-columns"},Pe={class:"column"},Ve={class:"subject"},ze={class:"column"},Je={class:"subject"},Ye={class:"column"},Ze={class:"subject"},qe={class:"row"},xe={class:"subject"},et=["readonly"],tt={class:"row"},nt={class:"subject"},ot={class:"etc"},st={class:"message"};function it(t,n,l,u,a,d){const r=(0,e.g2)("dropdown"),i=(0,e.g2)("format-number-input"),p=(0,e.g2)("checkbox"),v=(0,e.g2)("input-field");return(0,e.uX)(),(0,e.CE)("div",{class:(0,e.C4)(["rule-setting",t.formData.applied?"":"disabled"])},[(0,e.Lk)("div",Qe,[(0,e.Lk)("div",He,(0,e.v_)(t.i18n.eventLevel),1),n[4]||(n[4]=(0,e.eW)()),(0,e.bF)(r,{normal:"",width:250,items:t.eventLevelItems,disabled:!t.formData.applied,"selected-value":t.formData.level,onOnchange:t.onChangeEventLevel},null,8,["items","disabled","selected-value","onOnchange"])]),n[13]||(n[13]=(0,e.eW)()),(0,e.Lk)("div",Ue,[(0,e.Lk)("div",Pe,[(0,e.Lk)("div",Ve,(0,e.v_)(t.i18n.eventCheckTime),1),n[5]||(n[5]=(0,e.eW)()),(0,e.bF)(i,{width:100,disabled:!t.formData.applied,value:t.checkTimeRange,min:1,step:1,onInput:t.onInputCheckTimeRange},null,8,["disabled","value","onInput"]),(0,e.eW)(" "+(0,e.v_)(t.i18n.second),1)]),n[8]||(n[8]=(0,e.eW)()),(0,e.Lk)("div",ze,[(0,e.Lk)("div",Je,(0,e.v_)(t.i18n.eventCriterionTimes),1),n[6]||(n[6]=(0,e.eW)()),(0,e.bF)(i,{width:100,min:1,step:1,disabled:!t.formData.applied,value:t.formData.thresholdErrorCount,"onUpdate:value":n[0]||(n[0]=o=>t.formData.thresholdErrorCount=o)},null,8,["disabled","value"])]),n[9]||(n[9]=(0,e.eW)()),(0,e.Lk)("div",Ye,[(0,e.Lk)("div",Ze,(0,e.v_)(t.i18n.eventRollback),1),n[7]||(n[7]=(0,e.eW)()),(0,e.bF)(i,{width:100,disabled:!t.formData.applied,value:t.iconRecoveryTime,min:10,step:1,onInput:t.onInputIconRecoveryTime},null,8,["disabled","value","onInput"]),(0,e.eW)(" "+(0,e.v_)(t.i18n.second),1)])]),n[14]||(n[14]=(0,e.eW)()),(0,e.Lk)("div",qe,[(0,e.Lk)("div",xe,(0,e.v_)(t.i18n.M0394),1),n[10]||(n[10]=(0,e.eW)()),(0,e.bo)((0,e.Lk)("textarea",{readonly:!t.formData.applied,"onUpdate:modelValue":n[1]||(n[1]=o=>t.formData.customMessage=o)},null,8,et),[[e.Jo,t.formData.customMessage]])]),n[15]||(n[15]=(0,e.eW)()),n[16]||(n[16]=(0,e.Lk)("div",{class:"splitter"},null,-1)),n[17]||(n[17]=(0,e.eW)()),(0,e.Lk)("div",tt,[(0,e.Lk)("div",nt,[(0,e.bF)(p,{disabled:!t.formData.applied,label:t.i18n.scriptAutoRun,active:t.formData.scriptRunEnabled,"onUpdate:active":n[2]||(n[2]=o=>t.formData.scriptRunEnabled=o)},null,8,["disabled","label","active"])]),n[12]||(n[12]=(0,e.eW)()),(0,e.Lk)("div",ot,[(0,e.bF)(v,{width:490,disabled:!t.formData.applied,value:t.formData.autoScriptCommand,"onUpdate:value":n[3]||(n[3]=o=>t.formData.autoScriptCommand=o)},null,8,["disabled","value"]),n[11]||(n[11]=(0,e.eW)()),(0,e.Lk)("div",st,(0,e.v_)(t.i18n.M0039),1)])])],2)}var O=_(97953),M=_(11649),at=_(65267),B=_(88994);const lt=(0,e.pM)({inject:["i18n"],components:{FormatNumberInput:O.A,InputField:M.A,Dropdown:at.A,Checkbox:B.A},props:{settingData:{type:Object,required:!0}},setup(t,{emit:n}){const l=(0,e.WQ)("i18n",{normal:"NORMAL",warning:"WARNING",fatal:"FATAL"}),u=[{text:l.normal,value:"NORMAL"},{text:l.warning,value:"WARNING"},{text:l.fatal,value:"FATAL"}],a=(0,e.Kh)(t.settingData),d=(0,e.KR)(a.checkTimeRange/1e3),r=(0,e.KR)(a.iconRecoveryTime/1e3);return{i18n:l,eventLevelItems:u,formData:a,checkTimeRange:d,iconRecoveryTime:r,onChangeEventLevel:({value:o})=>{a.level=o},onInputCheckTimeRange:o=>{a.checkTimeRange=o*1e3,d.value=o},onInputIconRecoveryTime:o=>{a.iconRecoveryTime=o*1e3,r.value=o}}}}),$=(0,f.A)(lt,[["render",it],["__scopeId","data-v-0a62e0da"]]),dt={class:"row"},rt={class:"subject"},ut={class:"row"},pt={class:"subject"},_t=["readonly"],vt={class:"message"};function mt(t,n,l,u,a,d){const r=(0,e.g2)("format-number-input"),i=(0,e.g2)("tooltip");return(0,e.uX)(),(0,e.CE)("div",{class:(0,e.C4)(["disk-setting",t.eventApplied?"":"disabled"])},[(0,e.Lk)("div",dt,[(0,e.Lk)("div",rt,(0,e.v_)(t.i18n.diskUsage),1),n[3]||(n[3]=(0,e.eW)()),(0,e.bF)(i,{message:t.i18n.M0708},{default:(0,e.k6)(()=>[(0,e.bF)(r,{width:70,min:0,max:100,disabled:!t.eventApplied,value:t.formData.setting.percentageOfUsage,"onUpdate:value":n[0]||(n[0]=p=>t.formData.setting.percentageOfUsage=p)},null,8,["disabled","value"]),n[2]||(n[2]=(0,e.eW)(`
                %
            `))]),_:1,__:[2]},8,["message"])]),n[6]||(n[6]=(0,e.eW)()),(0,e.Lk)("div",ut,[(0,e.Lk)("div",pt,(0,e.v_)(t.i18n.partition),1),n[5]||(n[5]=(0,e.eW)()),(0,e.Lk)("div",null,[(0,e.bo)((0,e.Lk)("textarea",{readonly:!t.eventApplied,"onUpdate:modelValue":n[1]||(n[1]=p=>t.partitionListText=p)},null,8,_t),[[e.Jo,t.partitionListText]]),n[4]||(n[4]=(0,e.eW)()),(0,e.Lk)("div",vt,(0,e.v_)(t.i18n.M0706),1)])])],2)}var ct=_(8355);const gt=(0,e.pM)({inject:["i18n"],components:{FormatNumberInput:O.A,Tooltip:ct.A},props:{eventApplied:{type:Boolean,required:!1,default:!0},settingData:{type:Object,required:!0}},setup(t){const n=(0,e.WQ)("i18n",{}),l=(0,e.Kh)(t.settingData),u=(0,e.KR)(l.setting.partitionList.join(`
`)),a=(0,e.lW)(t,"eventApplied");return(0,e.wB)(u,d=>{const r=d.split(`
`);l.setting.partitionList=r.filter(i=>i.trim()!=="")}),(0,e.wB)(a,d=>{d||(l.setting.partitionList=[],l.setting.percentageOfUsage=0,u.value="")}),{i18n:n,formData:l,partitionListText:u,eventApplied:a}}}),X=(0,f.A)(gt,[["render",mt],["__scopeId","data-v-54720844"]]),yt={class:"main"},kt={class:"row"},ft={class:"subject"},St={class:"component"},Et={class:"column"},Lt={class:"subject"},Dt={class:"etc"};function Wt(t,n,l,u,a,d){const r=(0,e.g2)("toggle-switch"),i=(0,e.g2)("checkbox"),p=(0,e.g2)("input-field"),v=(0,e.g2)("window");return(0,e.uX)(),(0,e.Wv)(v,{class:"rule-window","open-w":420,"open-h":240,"open-x":t.position.left,"open-y":t.position.top,messages:{apply:t.i18n.save,cancel:t.i18n.cancel},onCancel:t.onClickCancelBtn,onApply:t.onClickApplyBtn},{subject:(0,e.k6)(()=>[(0,e.eW)((0,e.v_)(t.title),1)]),default:(0,e.k6)(()=>[n[6]||(n[6]=(0,e.eW)()),(0,e.Lk)("div",yt,[(0,e.Lk)("div",kt,[(0,e.Lk)("div",ft,(0,e.v_)(t.i18n.instanceGlobalRule),1),n[3]||(n[3]=(0,e.eW)()),(0,e.Lk)("div",St,[(0,e.bF)(r,{active:t.formData.applied,"onUpdate:active":n[0]||(n[0]=o=>t.formData.applied=o)},null,8,["active"])])]),n[5]||(n[5]=(0,e.eW)()),(0,e.Lk)("div",Et,[(0,e.Lk)("div",Lt,[(0,e.bF)(i,{disabled:!t.formData.applied,label:t.i18n.scriptAutoRun,active:t.formData.scriptRunEnabled,"onUpdate:active":n[1]||(n[1]=o=>t.formData.scriptRunEnabled=o)},null,8,["disabled","label","active"])]),n[4]||(n[4]=(0,e.eW)()),(0,e.Lk)("div",Dt,[(0,e.bF)(p,{width:352,disabled:!t.formData.applied,value:t.formData.autoScriptCommand,"onUpdate:value":n[2]||(n[2]=o=>t.formData.autoScriptCommand=o)},null,8,["disabled","value"])])])])]),_:1,__:[6]},8,["open-x","open-y","messages","onCancel","onApply"])}var j=_(67281);const bt=(0,e.pM)({inject:["i18n"],components:{Checkbox:B.A,ToggleSwitch:C.A,Window:j.A,InputField:M.A},props:{title:{type:String,required:!1,default:""},item:{type:Object,required:!0}},emits:["cancel","apply"],setup(t,{emit:n}){const l=(0,e.WQ)("i18n",{}),u=(0,e.KR)(t.item),a={left:window.innerWidth/2-210,top:window.innerHeight/2-120};return{i18n:l,formData:u,position:a,onClickCancelBtn:()=>{n("cancel")},onClickApplyBtn:()=>{n("apply",u.value)}}}}),Rt=(0,f.A)(bt,[["render",Wt],["__scopeId","data-v-39166c84"]]);var Ct=_(57222),T=_(48283),wt=_(28416);const G={instanceId:-1,instanceOid:-1,instanceName:"",applied:!1,scriptRunEnabled:!1,autoScriptCommand:""},Tt=(0,e.pM)({components:{RuleWindow:Rt,RuleSetting:$,DiskSetting:X,ToggleSwitch:C.A,Btn:N.A,InstanceSetting:Ke.A},setup(t){const n=(0,e.WQ)("i18n",{}),l=(0,E.P)("domain"),{state:u,commit:a,dispatch:d}=(0,E.P)("errorInRule"),{fullName:r,setFullName:i}=(0,wt.bs)(l.state.domainList),p=(0,e.EW)(()=>u.selectedErrorType.value===W.i8.NOT_ENOUGH_DISK_SPACE),v=(0,e.EW)(()=>u.selectedEventSettingForDomain),o=(0,e.EW)(()=>u.diskOptionInEventSetting),m=(0,e.EW)(()=>u.instanceOidToIdMap),s=(0,e.KR)({...v.value}),g=(0,e.KR)(G),D=new Map,w=(0,e.KR)({...o.value.value}),b=(0,e.KR)({data:{accessable:!0,batchjob:!1,index:"0",sid:s.value.domainId,title:""},label:"",noInteraction:!1,resourceType:"domain",treeIndex:"0"}),I=(0,e.KR)(v.value.individualSettings.length===0),xt=y=>{const S=y.sub,R=s.value.individualSettings.find(A=>A.instanceOid===S);R!==void 0&&(g.value={...R})},Q=async()=>{s.value.individualSettings=await(0,T.X1)(s.value.domainId,u.selectedErrorType.key),s.value.settingData.individualSetCount=s.value.individualSettings.length},en=async y=>{const S=[],R=[],A=y.oids.map(k=>m.value.get(k)),sn=s.value.individualSettings.map(k=>k.instanceId);s.value.individualSettings.forEach(k=>{y.oids.includes(k.instanceOid)||R.push(k.instanceId)}),R.forEach(k=>{S.push(d(c.QN.DELETE_ERROR_TARGET_IN_DOMAIN,{domainId:s.value.domainId,instanceId:k}))}),A.forEach(k=>{k!==void 0&&!sn.includes(k)&&S.push(d(c.QN.SAVE_ERROR_TARGETS_IN_DOMAIN,{domainId:s.value.domainId,instanceId:k,applied:s.value.settingData.applied,autoScriptCommand:s.value.settingData.autoScriptCommand,scriptRunEnabled:s.value.settingData.scriptRunEnabled}))}),S.length>0&&Ge.A.all(S).then(async()=>{await Q()})},H=()=>{g.value=G},tn=async y=>{const{data:S}=await d(c.QN.SAVE_ERROR_TARGETS_IN_DOMAIN,{domainId:s.value.domainId,instanceId:y.instanceId,applied:y.applied,autoScriptCommand:y.autoScriptCommand,scriptRunEnabled:y.scriptRunEnabled});S==="OK"&&(await Q(),H())},U=async()=>{const y={...v.value};y.settingData.individualSetCount=s.value.settingData.individualSetCount,a(c.lL.SET_ERROR_ROW_IN_DOMAIN,{...v.value}),a(c.lL.CHANGE_SCREEN_MODE,"list")},nn=()=>{d(c.QN.SAVE_ERROR_ROW_IN_DOMAIN,{domainId:s.value.domainId,instanceIds:s.value.individualSettings.map(y=>y.instanceId),settingData:s.value.settingData,autoScriptCommandMap:D}).then(()=>{if(p.value){const y={key:o.value.key,value:w.value};d(c.QN.SAVE_DISK_OPTION_IN_EVENT_SETTING,{domainId:s.value.domainId,applied:s.value.settingData.applied,diskOption:y})}}).finally(()=>{a(c.lL.CHANGE_SCREEN_MODE,"list")})},on=()=>{I.value=!I.value};return(0,Ct.v)(()=>{U()}),i(s.value.domainId),{i18n:n,formData:s,targetFormData:g,diskFormData:w,selectedDomain:b,isDiskErrorType:p,foldInstanceSetting:I,fullName:r,iconTypes:{open:L.B2.arrowUp,fold:L.B2.arrowDown},onClickCancelBtn:U,onClickSaveBtn:nn,onChangeTargetSetting:en,onSelectTargetSetting:xt,onToggleFoldInstanceSetting:on,onCancelTargetSettingWindow:H,onApplyTargetSettingWindow:tn,...(0,e.QW)(t)}}}),It=(0,f.A)(Tt,[["render",je],["__scopeId","data-v-6963bf01"]]);var At=_(91239);const ht={class:"error-header"},Ft={class:"left"},Nt={class:"name"},Ot={class:"right"};function Mt(t,n,l,u,a,d){const r=(0,e.g2)("btn"),i=(0,e.g2)("bulk-setting-window");return(0,e.uX)(),(0,e.CE)("div",ht,[(0,e.Lk)("div",Ft,[t.screenMode==="modify"?((0,e.uX)(),(0,e.Wv)(r,{key:0,normal:"",class:"border-none",items:[{iconType:t.backOptions.iconType}],onClick:t.onClickBackToList},null,8,["items","onClick"])):(0,e.Q3)("v-if",!0),n[0]||(n[0]=(0,e.eW)()),(0,e.Lk)("div",Nt,(0,e.v_)(t.subject),1)]),n[1]||(n[1]=(0,e.eW)()),(0,e.Lk)("div",Ot,[t.screenMode==="list"?((0,e.uX)(),(0,e.Wv)(r,{key:0,normal:"",items:[{text:t.i18n.bulkSetting}],pressed:t.showBulkWindow,disabled:t.checkedDomainIds.size===0,loading:t.bulkSettingLoading,onClick:t.onToggleBulkWindow},null,8,["items","pressed","disabled","loading","onClick"])):(0,e.Q3)("v-if",!0)]),n[2]||(n[2]=(0,e.eW)()),t.showBulkWindow?((0,e.uX)(),(0,e.Wv)(i,{key:0,onClose:t.onCloseBulkWindow},null,8,["onClose"])):(0,e.Q3)("v-if",!0)])}const Bt={class:"main"},$t={class:"row"},Xt={class:"subject"},jt={class:"component"},Gt={class:"message"},Kt={class:"scroll-view"},Qt={class:"row"},Ht={class:"row"};function Ut(t,n,l,u,a,d){const r=(0,e.g2)("toggle-switch"),i=(0,e.g2)("rule-setting"),p=(0,e.g2)("disk-setting"),v=(0,e.g2)("window");return(0,e.uX)(),(0,e.Wv)(v,{class:"bulk-setting-window","open-w":556,"open-h":726,"open-x":t.windowX,"open-y":t.windowY,messages:{apply:t.i18n.save,cancel:t.i18n.cancel},onCancel:t.onClickCancelBtn,onApply:t.onClickApplyBtn},{subject:(0,e.k6)(()=>[(0,e.eW)((0,e.v_)(t.i18n.bulkSetting),1)]),default:(0,e.k6)(()=>[n[11]||(n[11]=(0,e.eW)()),(0,e.Lk)("div",Bt,[(0,e.Lk)("div",$t,[(0,e.Lk)("div",Xt,(0,e.v_)(t.i18n.instanceGlobalRule),1),n[2]||(n[2]=(0,e.eW)()),(0,e.Lk)("div",jt,[(0,e.Lk)("span",Gt,(0,e.v_)(t.errorType.key),1),n[1]||(n[1]=(0,e.eW)()),(0,e.bF)(r,{active:t.eventSetting.applied,"onUpdate:active":n[0]||(n[0]=o=>t.eventSetting.applied=o)},null,8,["active"])])]),n[8]||(n[8]=(0,e.eW)()),n[9]||(n[9]=(0,e.Lk)("div",{class:"splitter"},null,-1)),n[10]||(n[10]=(0,e.eW)()),(0,e.Lk)("div",Kt,[(0,e.Lk)("div",Qt,[(0,e.Lk)("div",{class:"subject",style:(0,e.Tr)({opacity:t.eventSetting.applied?1:.6})},(0,e.v_)(t.i18n.setting),5),n[3]||(n[3]=(0,e.eW)()),(0,e.bF)(i,{"setting-data":t.eventSetting},null,8,["setting-data"])]),n[7]||(n[7]=(0,e.eW)()),t.isDiskErrorType?((0,e.uX)(),(0,e.CE)(e.FK,{key:0},[n[5]||(n[5]=(0,e.Lk)("div",{class:"splitter"},null,-1)),n[6]||(n[6]=(0,e.eW)()),(0,e.Lk)("div",Ht,[(0,e.Lk)("div",{class:"subject",style:(0,e.Tr)({opacity:t.eventSetting.applied?1:.6})},(0,e.v_)(t.i18n.diskLinkageSetting),5),n[4]||(n[4]=(0,e.eW)()),(0,e.bF)(p,{"event-applied":t.eventSetting.applied,"setting-data":t.diskOption.value},null,8,["event-applied","setting-data"])])],64)):(0,e.Q3)("v-if",!0)])])]),_:1,__:[11]},8,["open-x","open-y","messages","onCancel","onApply"])}const Pt=(0,e.pM)({inject:["i18n","windowSize"],components:{Window:j.A,ToggleSwitch:C.A,RuleSetting:$,DiskSetting:X},emits:["close"],setup(t,{emit:n}){const{state:l,dispatch:u}=(0,E.P)("errorInRule"),a=(0,e.WQ)("i18n",{}),d=(0,e.WQ)("windowSize",{width:window.innerWidth,height:window.innerHeight}),r=(0,e.EW)(()=>l.selectedErrorType.value===W.i8.NOT_ENOUGH_DISK_SPACE),i=(0,e.EW)(()=>l.selectedErrorType),p=(0,e.KR)((0,T.X3)(i.value)),v=(0,e.KR)((0,T.XT)()),o=(0,e.EW)(()=>d.width/2-556/2),m=(0,e.EW)(()=>d.height/2-726/2),s=()=>{n("close")};return{i18n:a,errorType:i,eventSetting:p,diskOption:v,isDiskErrorType:r,windowX:o,windowY:m,onClickCancelBtn:s,onClickApplyBtn:()=>{u(c.QN.BULK_ERROR_AND_DISK_ROW_IN_DOMAINS,{eventSetting:p.value,diskOption:v.value}),s()}}}}),Vt=(0,f.A)(Pt,[["render",Ut],["__scopeId","data-v-0a5edea2"]]),zt=(0,e.pM)({components:{Btn:N.A,SvgIcon:L.Ah,BulkSettingWindow:Vt},setup(t){const n=(0,e.WQ)("i18n",{}),{state:l,commit:u}=(0,E.P)("errorInRule"),a=(0,e.EW)(()=>l.screenMode),d=(0,e.EW)(()=>l.selectedErrorType),r=(0,e.EW)(()=>l.checkedDomainIds),i=(0,e.EW)(()=>l.bulkSettingLoading),p=(0,e.EW)(()=>l.selectedEventSettingForDomain),v=(0,e.KR)(d.value.key),o=(0,e.KR)(!1);(0,e.wB)(d,()=>{a.value==="list"&&(v.value=d.value.key,o.value=!1)}),(0,e.wB)(r,()=>{r.value.size===0&&(o.value=!1)}),(0,e.wB)(a,()=>{v.value=a.value==="list"?d.value.key:p.value.domain});const m=()=>{o.value=!o.value},s=()=>{o.value=!1},g=()=>{u(c.lL.CHANGE_SCREEN_MODE,"list")};return{backOptions:{iconType:L.B2.arrowBack},i18n:n,screenMode:a,subject:v,showBulkWindow:o,checkedDomainIds:r,bulkSettingLoading:i,onClickBackToList:g,onToggleBulkWindow:m,onCloseBulkWindow:s}}}),Jt=(0,f.A)(zt,[["render",Mt],["__scopeId","data-v-fd7d74fa"]]);var K=_(73530),Yt=_(53406);const Zt=(0,e.pM)({components:{ErrorTypeLayer:le,DomainList:Ee,DomainForm:It,LoadingPage:At.A,ErrorHeader:Jt},setup(){(0,e.Gt)("i18n",K.A);const{state:t,dispatch:n}=(0,E.P)("errorInRule"),l=(0,e.EW)(()=>t.loadingPercent),u=(0,e.EW)(()=>t.screenMode),a=(0,e.EW)(()=>t.useDomainGroup),d=(0,e.EW)(()=>t.domainGroupTree),r=(0,e.EW)(()=>t.domainList),i=(0,e.KR)([]);return n(c.QN.LOAD_RELATED_DOMAIN_ALL).then(()=>{i.value=(0,Yt.t4)(a.value,d.value,r.value).filter(p=>p.domainList.length>0)}),{loadingPercent:l,screenMode:u,domainListInGroup:i,i18nMessages:K.A}}}),qt=(0,f.A)(Zt,[["render",x]])}}]);
