(()=>{"use strict";var V={21005:(r,u,l)=>{l.d(u,{A:()=>d});var m=l(6687);const d=m.A},77744:(r,u,l)=>{class m{constructor(t,s,i,o=255){this.red=t,this.green=s,this.blue=i,this.alpha=o}toTextHex(){return"#"+d(this.red)+d(this.green)+d(this.blue)}toTextRgba(){return"rgba("+this.red+", "+this.green+", "+this.blue+", "+this.alpha/255+")"}to32bit(){return this.alpha<<24|this.blue<<16|this.green<<8|this.red}to32bitBigEndian(){return this.blue<<24|this.alpha<<16|this.red<<8|this.green}clone(){return Object.assign(Object.create(this),this)}}const d=n=>{const t=n.toString(16);return t.length<2?"0"+t:t},_=new m(187,160,255),R=new m(148,109,255),y=new m(72,56,135),v=new m(148,109,255,20),U=new m(148,109,255,40),J=[new m(106,103,218),new m(110,182,233),new m(135,187,102)],Q=[new m(255,109,75),new m(255,151,29),new m(255,199,6)],ae=J.map(n=>n.to32bit()),le=J.map(n=>n.to32bitBigEndian()),B=Q.map(n=>n.to32bit()),ce=Q.map(n=>n.to32bitBigEndian());var fe=l(43314),L=l.n(fe),he=l(9592),ue=l.n(he),de=l(31814),pe=l.n(de);L().extend(ue()),L().extend(pe());const W=L();var me=l(21005),j=l(92135),Te=l(29100);const f=(n,t,s)=>{n.length>t&&(n[t]=s)},_e=(n,t,s,i,o)=>{let e=i*t+s|0;f(n,e,o),f(n,e+1,o),f(n,e+3,o),f(n,e+4,o),e+=t|0,f(n,e,o),f(n,e+1,o),f(n,e+2,o),f(n,e+3,o),f(n,e+4,o),e+=t|0,f(n,e+1,o),f(n,e+2,o),f(n,e+3,o),e+=t|0,f(n,e,o),f(n,e+1,o),f(n,e+2,o),f(n,e+3,o),f(n,e+4,o),e+=t|0,f(n,e,o),f(n,e+1,o),f(n,e+3,o),f(n,e+4,o)},ge=(n,t,s,i,o)=>{let e=i*t+s|0;f(n,e,o),f(n,e+2,o),e+=t|0,f(n,e+1,o),e+=t|0,f(n,e,o),f(n,e+2,o)},q=(n,t,s,i,o,e,c)=>{Array.from(Array(o*2+1).keys()).map(T=>T-o).forEach(T=>{const b=Math.min(o,o-Math.abs(T)+1),C=Math.min(b+1,o);Array.from(Array(C*2+1).keys()).map(p=>p-C).forEach(p=>{const g={x:s+p,y:i+T};if(0<=g.x&&g.x<t){const I=g.y*t+g.x|0,O=Math.abs(p)<=b?e:c;f(n,I,O)}})})},Re=(n,t,s,i,o)=>{const e=o.clone(),c=e.to32bit();e.alpha=100;const T=e.to32bit();s.forEach(b=>{const C=b%t,p=Math.floor(b/t);q(n,t,C,p,i,c,T)})},Se=(n,t,s,i,o)=>{const e=o.clone(),c=e.to32bit();e.alpha=255*.15;const T=e.to32bit();e.alpha=255*.07;const b=e.to32bit();s.forEach((C,p)=>{const g=p%t,I=Math.floor(p/t);q(n,t,g,I,i,c,T)})};class ee{constructor(t){this.ADDRESS_BITS_PER_UNIT=5,this.BITS_PER_UNIT=1<<this.ADDRESS_BITS_PER_UNIT,this.BIT_INDEX_MASK=this.BITS_PER_UNIT-1,this.capacity_1=t-1,this.bits=new Array(this.unitIndex(t-1)+1),this.unitsInUse=0}bit(t){return 1<<(t&this.BIT_INDEX_MASK)}mark(t){var s=this.unitIndex(t),i=s+1;typeof this.bits[s]>"u"&&(this.bits[s]=0),this.unitsInUse<i?(this.bits[s]|=this.bit(t),this.unitsInUse=i):this.bits[s]|=this.bit(t)}clear(){for(;this.unitsInUse>0;)this.bits[--this.unitsInUse]=0}isMarked(t){var s=!1,i=this.unitIndex(t);return i<this.unitsInUse&&(s=(this.bits[i]&this.bit(t))!==0),s}unitIndex(t){return t>>this.ADDRESS_BITS_PER_UNIT}toString(){var t=[];for(var s in this)t.push(s+" : "+this[s]);return Console.log(t.join(","))}}const te=new Uint32Array(new Uint8Array([1,2,3,4]).buffer)[0]===67305985,S=[],w=[],P=[],ne=new Set,F=[],H=(0,j.A)(),z=(0,j.A)().clamp(!0),X=(0,j.A)().clamp(!0);let x,Y,M=[0,1],G=[0,1],k=!1,se=!1,D=0,A=0,oe=!1;function E(n,t,s){const i=n[s]>1e3?1e3:500,o=s==="frontendTime"||s==="networkTime",e=o?0:n[s],c=o?0:t[s];return Math.floor(e/i)==Math.floor(c/i)}function Oe(){const n=[];for(let t=0;t<P.length;t++){let s=P[t],i=!1;for(let o=0;o<n.length;o++){let e=n[o];if(e.errorType===s.errorType&&E(e,s,"responseTime")&&E(e,s,"frontendTime")&&E(e,s,"networkTime")&&E(e,s,"cpuTime")&&E(e,s,"sqlTime")&&E(e,s,"fetchTime")&&E(e,s,"externalcallTime")){i=!0;break}}i||n.push(s)}n.forEach(t=>ne.add(t.txid))}async function Ie(n,t,s,i,o,e,c,T,b,C){const p={elapsedTime:"responseTime",sqlTime:"sqlTime",txcallTime:"externalcallTime",cpuTime:"cpuTime",fetchTime:"fetchTime"};let g=S.length;try{const{data:I}=await me.A.post("/api-v2/transaction/time-range",{instanceOidByDomain:n,startTime:t,endTime:s});for(let O=0;O<I.length;O++){const h=I[O];if(o&&h.errorType===""||e&&!h.linkRoot||c&&!h.hasStacktrace||T&&!h.async||b&&h.async)continue;D>=3&&(D=0),A>=3&&(A=0);const N=h[p[i]];S.push({sid:h.domainId,txid:h.txid,time:parseInt(h.endTime),value:N,error:h.errorType,color:h.errorType===""?D:A,linked:h.linkRoot,stacked:h.hasStacktrace,async:h.async,sync:!h.async}),h.errorType===""?D++:A++,C&&P.push(h)}return F.push([g,S.length]),self.postMessage({type:"update.total",count:S.length,isLoading:!0}),!0}catch{return F.push([g,g]),!1}}async function xe({instanceOidByDomain:n,startTime:t,endTime:s,utcOffset:i,viewPoint:o,isOnlyError:e,isOnlyLinked:c,isOnlyStacked:T,isOnlyAsync:b,isOnlySync:C,isOnlyRepresentative:p}){const g=W(t).utcOffset(i),I=W(s).utcOffset(i);let O=g;for(;O.isBefore(I);){const h=O.add(1,"minute"),N=await Ie(n,O.valueOf(),h.valueOf(),o,e,c,T,b,C,p);O=h}}function ie(n,t){let s=-1,i=-1;const o=Math.floor(H(n)),e=Math.ceil(H(t));for(let c=o;c<=e;c++){const T=F[c];T!==void 0&&(s===-1&&(s=T[0]),i=Math.max(i,T[1]))}return[s,i]}function Ce(n){const t=new ee(x.width*x.height/9),s=new ee(x.width*x.height/9),i=Y.createImageData(x.width,x.height),o=new Uint32Array(i.data.buffer),e=k?3:2,c=k?_e:ge,T=te?ae:le,b=te?B:ce,C=[];for(let p=0;p<n.length;p++){const[g,I,O,h]=n[p];if(I>-1){const N=parseInt(`${z(g)}`)-e,K=parseInt(`${X(I)}`)-e,$=~~(N/3*x.height+K/3);if(O===""){if(t.isMarked($))continue;t.mark($),c(o,x.width,N,K,T[h])}else C.push([N,K,$,h])}}for(let p=0;p<C.length;p++){const[g,I,O,h]=C[p];s.isMarked(O)||(s.mark(O),c(o,x.width,g,I,b[h]))}Y.putImageData(i,0,0),self.postMessage({type:"render"})}function re(){const[n,t]=ie(...M);if(!(!oe&&S.length>t)){if(!se){let s=-1;w.length=0;const i={errorCount:0,linkedCount:0,stackedCount:0,asyncCount:0,syncCount:0};for(let o=n;o<t;o++){const e=S[o];if(!(P.length>0&&!ne.has(e.txid))&&e.time>=M[0]&&e.time<=M[1]){const c=[e.time,e.value,e.error,e.color];e.error!==""&&i.errorCount++,e.linked&&i.linkedCount++,e.stacked&&i.stackedCount++,e.async&&i.asyncCount++,e.async||i.syncCount++,e.value>s&&(s=e.value),w.push(c)}}self.postMessage({type:"update.view",count:w.length,counts:i,maxValue:s,patternTransactions:w})}Ce(w)}}function be(n){const t={},[s,i]=ie(...n.xRange);let o=0;for(let e=s;e<i;e++){const c=S[e];c.time>=n.xRange[0]&&c.time<=n.xRange[1]&&c.value>=n.yRange[0]&&(n.yRange[1]===G[1]||c.value<=n.yRange[1])&&(t[c.sid]||(t[c.sid]=[]),t[c.sid].push(c.txid),o++)}o>0&&self.postMessage({type:"analysis",transactionIds:t})}self.onmessage=async n=>{const{type:t,api:s,chart:i,offscreen:o,drag:e}=n.data;if(t==="api"&&s!==void 0)try{H.domain([s.startTime,s.endTime]).range([0,(s.endTime-s.startTime)/Te.C.ONE_MINUTE-1]),await xe(s),s.isOnlyRepresentative&&Oe(),self.postMessage({type:"update.total",count:S.length,isLoading:!1}),oe=!0}catch{}else if(t.startsWith("chart.")&&i!==void 0)if(M=i.xDomain,G=i.yDomain,k=i.isBigSize,se=i.isResize,z.domain(M),X.domain(G),t==="chart.init"&&o){x=o,Y=x.getContext("2d");const c=k?3:2;z.range([c,x.width-c]),X.range([x.height-c,c]),re()}else t==="chart.draw"&&re();else t==="drag"&&e!==void 0&&be(e)}}},Z={};function a(r){var u=Z[r];if(u!==void 0)return u.exports;var l=Z[r]={exports:{}};return V[r].call(l.exports,l,l.exports,a),l.exports}a.m=V,a.x=()=>{var r=a.O(void 0,[25020,6687,92135,81248],()=>a(77744));return r=a.O(r),r},(()=>{var r=[];a.O=(u,l,m,d)=>{if(l){d=d||0;for(var _=r.length;_>0&&r[_-1][2]>d;_--)r[_]=r[_-1];r[_]=[l,m,d];return}for(var R=1/0,_=0;_<r.length;_++){for(var[l,m,d]=r[_],y=!0,v=0;v<l.length;v++)(d&!1||R>=d)&&Object.keys(a.O).every(B=>a.O[B](l[v]))?l.splice(v--,1):(y=!1,d<R&&(R=d));if(y){r.splice(_--,1);var U=m();U!==void 0&&(u=U)}}return u}})(),a.n=r=>{var u=r&&r.__esModule?()=>r.default:()=>r;return a.d(u,{a:u}),u},a.d=(r,u)=>{for(var l in u)a.o(u,l)&&!a.o(r,l)&&Object.defineProperty(r,l,{enumerable:!0,get:u[l]})},a.f={},a.e=r=>Promise.all(Object.keys(a.f).reduce((u,l)=>(a.f[l](r,u),u),[])),a.u=r=>""+(r===25020?"base/common":r)+".js",a.miniCssF=r=>{},a.o=(r,u)=>Object.prototype.hasOwnProperty.call(r,u),a.r=r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},a.j=77744,a.p="/bundles/",(()=>{var r={77744:1},u=d=>{var[_,R,y]=d;for(var v in R)a.o(R,v)&&(a.m[v]=R[v]);for(y&&y(a);_.length;)r[_.pop()]=1;m(d)};a.f.i=(d,_)=>{r[d]||importScripts(a.p+a.u(d))};var l=self.webpackChunkjennifer5_frontend=self.webpackChunkjennifer5_frontend||[],m=l.push.bind(l);l.push=u})(),(()=>{var r=a.x;a.x=()=>Promise.all([25020,6687,92135,81248].map(a.e,a)).then(r)})();var ve=a.x()})();
